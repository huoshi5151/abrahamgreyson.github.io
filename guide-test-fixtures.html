<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/41d5631d/css/bootstrap.css" rel="stylesheet">
<link href="./assets/bad56eea/style.css" rel="stylesheet">
<script src="./assets/e17319cf/jquery.js"></script>
<script src="./assets/41d5631d/js/bootstrap.js"></script>
<script src="./assets/b52a7f0/jssearch.js"></script>    <title>Yii Framework 2.0 API Documentation</title>
</head>
<body>

<div class="wrap">
    <nav id="w1739" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w1739-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">Yii 2.0 API 文档</a></div><div id="w1739-collapse" class="collapse navbar-collapse"><ul id="w1740" class="navbar-nav nav"><li><a href="./index.html">类参考</a></li>
<li class="dropdown"><a class="dropdown-toggle" href="#" data-toggle="dropdown">扩展 <b class="caret"></b></a><ul id="w1741" class="dropdown-menu"><li><a href="./ext-apidoc-index.html" tabindex="-1">apidoc</a></li>
<li><a href="./ext-authclient-index.html" tabindex="-1">authclient</a></li>
<li><a href="./ext-bootstrap-index.html" tabindex="-1">bootstrap</a></li>
<li><a href="./ext-codeception-index.html" tabindex="-1">codeception</a></li>
<li><a href="./ext-composer-index.html" tabindex="-1">composer</a></li>
<li><a href="./ext-debug-index.html" tabindex="-1">debug</a></li>
<li><a href="./ext-elasticsearch-index.html" tabindex="-1">elasticsearch</a></li>
<li><a href="./ext-faker-index.html" tabindex="-1">faker</a></li>
<li><a href="./ext-gii-index.html" tabindex="-1">gii</a></li>
<li><a href="./ext-imagine-index.html" tabindex="-1">imagine</a></li>
<li><a href="./ext-jui-index.html" tabindex="-1">jui</a></li>
<li><a href="./ext-mongodb-index.html" tabindex="-1">mongodb</a></li>
<li><a href="./ext-redis-index.html" tabindex="-1">redis</a></li>
<li><a href="./ext-smarty-index.html" tabindex="-1">smarty</a></li>
<li><a href="./ext-sphinx-index.html" tabindex="-1">sphinx</a></li>
<li><a href="./ext-swiftmailer-index.html" tabindex="-1">swiftmailer</a></li>
<li><a href="./ext-twig-index.html" tabindex="-1">twig</a></li></ul></li>
<li><a href="./guide-README.html">权威指南</a></li>
<li class="dropdown"><a class="dropdown-toggle" href="#" data-toggle="dropdown">Github <b class="caret"></b></a><ul id="w1742" class="dropdown-menu"><li><a href="https://github.com/yiisoft/yii2" tabindex="-1">Yii 2.0</a></li>
<li><a href="https://github.com/yii2-chinesization/yii2-zh-cn" tabindex="-1">Yii 2.0 中文化项目</a></li>
<li><a href="https://github.com/AbrahamGreyson/abrahamgreyson.github.io" tabindex="-1">docwithcn.com</a></li></ul></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-1722" data-toggle="collapse" data-parent="#navigation">介绍 <b class="caret"></b></a><div id="navigation-1722" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-intro-yii.html">�
�于 Yii</a>
<a class="list-group-item" href="./guide-intro-upgrade-from-v1.html">从 Yii 1.1 升级</a></div>
<a class="list-group-item" href="#navigation-1723" data-toggle="collapse" data-parent="#navigation">�门 <b class="caret"></b></a><div id="navigation-1723" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-start-installation.html">安�
 Yii</a>
<a class="list-group-item" href="./guide-start-workflow.html">运行应用</a>
<a class="list-group-item" href="./guide-start-hello.html">第一次问候</a>
<a class="list-group-item" href="./guide-start-forms.html">使用 Forms</a>
<a class="list-group-item" href="./guide-start-databases.html">玩转 Databases</a>
<a class="list-group-item" href="./guide-start-gii.html">用 Gii 生成代码</a>
<a class="list-group-item" href="./guide-start-looking-ahead.html">更上一层楼</a></div>
<a class="list-group-item" href="#navigation-1724" data-toggle="collapse" data-parent="#navigation">应用结构 <b class="caret"></b></a><div id="navigation-1724" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-structure-overview.html">结构概述</a>
<a class="list-group-item" href="./guide-structure-entry-scripts.html">�
�口脚本</a>
<a class="list-group-item" href="./guide-structure-applications.html">应用</a>
<a class="list-group-item" href="./guide-structure-application-components.html">应用组件</a>
<a class="list-group-item" href="./guide-structure-controllers.html">控制器（Controller）</a>
<a class="list-group-item" href="./guide-structure-views.html">视图（View）</a>
<a class="list-group-item" href="./guide-structure-models.html">模型（Model）</a>
<a class="list-group-item" href="./guide-structure-filters.html">过滤器</a>
<a class="list-group-item" href="./guide-structure-widgets.html">小部件（Widget）</a>
<a class="list-group-item" href="./guide-structure-modules.html">模块（Module）</a>
<a class="list-group-item" href="./guide-structure-assets.html">前端资源（Asset）</a>
<a class="list-group-item" href="./guide-structure-extensions.html">扩展（extensions）</a></div>
<a class="list-group-item" href="#navigation-1725" data-toggle="collapse" data-parent="#navigation">请求处理 <b class="caret"></b></a><div id="navigation-1725" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-runtime-overview.html">运行概述</a>
<a class="list-group-item" href="./guide-runtime-bootstrapping.html">引导（Bootstrapping）</a>
<a class="list-group-item" href="./guide-runtime-routing.html">路由（Routing）</a>
<a class="list-group-item" href="./guide-runtime-requests.html">请求（Request）</a>
<a class="list-group-item" href="./guide-runtime-responses.html">响应（Response）</a>
<a class="list-group-item" href="./guide-runtime-sessions-cookies.html">Sessions（会话）和 Cookies</a>
<a class="list-group-item" href="./guide-runtime-url-handling.html">URL 解析和生成</a>
<a class="list-group-item" href="./guide-runtime-handling-errors.html">错误处理</a>
<a class="list-group-item" href="./guide-runtime-logging.html">日志</a></div>
<a class="list-group-item" href="#navigation-1726" data-toggle="collapse" data-parent="#navigation">�键概念 <b class="caret"></b></a><div id="navigation-1726" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-concept-components.html">组件（Component）</a>
<a class="list-group-item" href="./guide-concept-properties.html">属性（Property）</a>
<a class="list-group-item" href="./guide-concept-events.html">事件（Event）</a>
<a class="list-group-item" href="./guide-concept-behaviors.html">行为（Behavior）</a>
<a class="list-group-item" href="./guide-concept-configurations.html">�
�置（Configurations）</a>
<a class="list-group-item" href="./guide-concept-autoloading.html">类自动加载（Autoloading）</a>
<a class="list-group-item" href="./guide-concept-alias.html">别名（Alias）</a>
<a class="list-group-item" href="./guide-concept-service-locator.html">服务定位器（Service Locator）</a>
<a class="list-group-item" href="./guide-concept-di-container.html">依赖注�
�容器（DI Container）</a></div>
<a class="list-group-item" href="#navigation-1727" data-toggle="collapse" data-parent="#navigation">�合数据库工作 <b class="caret"></b></a><div id="navigation-1727" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-db-dao.html">数据访问对象（DAO）</a>
<a class="list-group-item" href="./guide-db-query-builder.html">查询生成器（Query Builder）</a>
<a class="list-group-item" href="./guide-db-active-record.html">活动记录（Active Record）</a>
<a class="list-group-item" href="./guide-db-migrations.html">数据库迁移（Migration）</a>
<a class="list-group-item" href="./guide-db-sphinx.html">Sphinx</a>
<a class="list-group-item" href="./guide-db-redis.html">Redis</a>
<a class="list-group-item" href="./guide-db-mongodb.html">MongoDB</a>
<a class="list-group-item" href="./guide-db-elastic-search.html">ElasticSearch</a></div>
<a class="list-group-item" href="#navigation-1728" data-toggle="collapse" data-parent="#navigation">接收用户数据 <b class="caret"></b></a><div id="navigation-1728" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-input-forms.html">创建表单</a>
<a class="list-group-item" href="./guide-input-validation.html">输�
�验证</a>
<a class="list-group-item" href="./guide-input-file-uploading.html">文件上传</a>
<a class="list-group-item" href="./guide-input-multiple-models.html">多模型同时输�
�</a></div>
<a class="list-group-item" href="#navigation-1729" data-toggle="collapse" data-parent="#navigation">显示数据 <b class="caret"></b></a><div id="navigation-1729" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-output-formatter.html">格式化输出数据</a>
<a class="list-group-item" href="./guide-output-pagination.html">分页（Pagination）</a>
<a class="list-group-item" href="./guide-output-sorting.html">排序（Sorting）</a>
<a class="list-group-item" href="./guide-output-data-providers.html">数据提供器</a>
<a class="list-group-item" href="./guide-output-data-widgets.html">数据小部件</a>
<a class="list-group-item" href="./guide-output-theming.html">主题</a></div>
<a class="list-group-item" href="#navigation-1730" data-toggle="collapse" data-parent="#navigation">� <b class="caret"></b></a><div id="navigation-1730" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-security-authentication.html">认证（Authentication）</a>
<a class="list-group-item" href="./guide-security-authorization.html">授权（Authorization）</a>
<a class="list-group-item" href="./guide-security-passwords.html">处理密码</a>
<a class="list-group-item" href="./guide-security-auth-clients.html">客户端认证</a>
<a class="list-group-item" href="./guide-security-best-practices.html">安�
�领域的最佳实践</a></div>
<a class="list-group-item" href="#navigation-1731" data-toggle="collapse" data-parent="#navigation">缓存 <b class="caret"></b></a><div id="navigation-1731" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-caching-overview.html">概述</a>
<a class="list-group-item" href="./guide-caching-data.html">数据缓存</a>
<a class="list-group-item" href="./guide-caching-fragment.html">片段缓存</a>
<a class="list-group-item" href="./guide-caching-page.html">分页缓存</a>
<a class="list-group-item" href="./guide-caching-http.html">HTTP 缓存</a></div>
<a class="list-group-item" href="#navigation-1732" data-toggle="collapse" data-parent="#navigation">RESTful Web 服务 <b class="caret"></b></a><div id="navigation-1732" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-rest-quick-start.html">快速�
�门</a>
<a class="list-group-item" href="./guide-rest-resources.html">资源</a>
<a class="list-group-item" href="./guide-rest-routing.html">路由</a>
<a class="list-group-item" href="./guide-rest-response-formatting.html">格式化响应</a>
<a class="list-group-item" href="./guide-rest-authentication.html">授权验证</a>
<a class="list-group-item" href="./guide-rest-rate-limiting.html">速率限制</a>
<a class="list-group-item" href="./guide-rest-versioning.html">版本化</a>
<a class="list-group-item" href="./guide-rest-error-handling.html">错误处理</a>
<a class="list-group-item" href="./guide-rest-testing.html">测试</a></div>
<a class="list-group-item" href="#navigation-1733" data-toggle="collapse" data-parent="#navigation">� <b class="caret"></b></a><div id="navigation-1733" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-tool-debugger.html">调试工�
�栏和调试器</a>
<a class="list-group-item" href="./guide-tool-gii.html">使用 Gii 生成代码</a>
<a class="list-group-item" href="./guide-tool-api-doc.html">生成 API 文档</a></div>
<a class="list-group-item active" href="#navigation-1734" data-toggle="collapse" data-parent="#navigation">测试 <b class="caret"></b></a><div id="navigation-1734" class="submenu panel-collapse collapse in"><a class="list-group-item" href="./guide-test-overview.html">概述</a>
<a class="list-group-item" href="./guide-test-endvironment-setup.html">搭建测试环境</a>
<a class="list-group-item" href="./guide-test-unit.html">单�
�测试</a>
<a class="list-group-item" href="./guide-test-functional.html">功能测试</a>
<a class="list-group-item" href="./guide-test-acceptance.html">验收测试</a>
<a class="list-group-item active" href="./guide-test-fixtures.html">测试夹�
�</a></div>
<a class="list-group-item" href="#navigation-1735" data-toggle="collapse" data-parent="#navigation">高级专题 <b class="caret"></b></a><div id="navigation-1735" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-tutorial-advanced-app.html">高级应用模版</a>
<a class="list-group-item" href="./guide-tutorial-start-from-scratch.html">从头构建自定义模版</a>
<a class="list-group-item" href="./guide-tutorial-console.html">控制台命令</a>
<a class="list-group-item" href="./guide-tutorial-core-validators.html">核心验证器</a>
<a class="list-group-item" href="./guide-tutorial-i18n.html">国�
化</a>
<a class="list-group-item" href="./guide-tutorial-mailing.html">收发邮件</a>
<a class="list-group-item" href="./guide-tutorial-performance-tuning.html">性能优化</a>
<a class="list-group-item" href="./guide-tutorial-shared-hosting.html">�
�享主机环境</a>
<a class="list-group-item" href="./guide-tutorial-template-engines.html">模板引擎</a>
<a class="list-group-item" href="./guide-tutorial-yii-integration.html">集成第三方代码</a></div>
<a class="list-group-item" href="#navigation-1736" data-toggle="collapse" data-parent="#navigation">小部件 <b class="caret"></b></a><div id="navigation-1736" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-widget-bootstrap.html">Bootstrap 小部件</a>
<a class="list-group-item" href="./guide-widget-jui.html">Jquery UI 小部件</a></div>
<a class="list-group-item" href="#navigation-1737" data-toggle="collapse" data-parent="#navigation">助手类 <b class="caret"></b></a><div id="navigation-1737" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-helper-overview.html">助手一览</a>
<a class="list-group-item" href="./guide-helper-array.html">ArrayHelper</a>
<a class="list-group-item" href="./guide-helper-html.html">Html</a>
<a class="list-group-item" href="./guide-helper-url.html">Url</a>
<a class="list-group-item" href="./guide-helper-security.html">security</a></div>
<a class="list-group-item" href="#navigation-1738" data-toggle="collapse" data-parent="#navigation">的文件 <b class="caret"></b></a><div id="navigation-1738" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-glossary.html">glossary</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>Fixtures <a href="#fixtures" name="fixtures" class="hashlink">&para;</a></h1><blockquote><p>Note: This section is under development.</p>
</blockquote>
<p>Fixtures are important part of testing. Their main purpose is to set up the environment in a fixed/known state
so that your tests are repeatable and run in an expected way. Yii provides a fixture framework that allows
you to define your fixtures precisely and use them easily.</p>
<p>A key concept in the Yii fixture framework is the so-called <em>fixture objects</em>. A fixture object represents
a particular aspect of a test environment and is an instance of <a href="./yii-test-fixture.html">yii\test\Fixture</a> or its child class. For example,
you may use <code>UserFixture</code> to make sure the user DB table contains a fixed set of data. You load one or multiple
fixture objects before running a test and unload them when finishing.</p>
<p>A fixture may depend on other fixtures, specified via its <a href="./yii-test-fixture.html#$depends-detail">yii\test\Fixture::$depends</a> property.
When a fixture is being loaded, the fixtures it depends on will be automatically loaded BEFORE the fixture;
and when the fixture is being unloaded, the dependent fixtures will be unloaded AFTER the fixture.</p>
<h2>Defining a Fixture <a href="#defining-a-fixture" name="defining-a-fixture" class="hashlink">&para;</a></h2><p>To define a fixture, create a new class by extending <a href="./yii-test-fixture.html">yii\test\Fixture</a> or <a href="./yii-test-activefixture.html">yii\test\ActiveFixture</a>.
The former is best suited for general purpose fixtures, while the latter has enhanced features specifically
designed to work with database and ActiveRecord.</p>
<p>The following code defines a fixture about the <code>User</code> ActiveRecord and the corresponding user table.</p>
<pre><code class="language-php"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">tests</span><span style="color: #007700">\</span><span style="color: #0000BB">fixtures</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">test</span><span style="color: #007700">\</span><span style="color: #0000BB">ActiveFixture</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">UserFixture&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">ActiveFixture<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$modelClass&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'app\models\User'</span><span style="color: #007700">;<br />}</span></code></pre>
<blockquote><p>Tip: Each <code>ActiveFixture</code> is about preparing a DB table for testing purpose. You may specify the table
by setting either the <a href="./yii-test-activefixture.html#$tableName-detail">yii\test\ActiveFixture::$tableName</a> property or the <a href="./yii-test-baseactivefixture.html#$modelClass-detail">yii\test\ActiveFixture::$modelClass</a>
property. If the latter, the table name will be taken from the <code>ActiveRecord</code> class specified by <code>modelClass</code>.</p>
</blockquote>
<p>The fixture data for an <code>ActiveFixture</code> fixture is usually provided in a file located at <code>FixturePath/data/TableName.php</code>,
where <code>FixturePath</code> stands for the directory containing the fixture class file, and <code>TableName</code>
is the name of the table associated with the fixture. In the example above, the file should be
<code>@app/tests/fixtures/data/user.php</code>. The data file should return an array of data rows
to be inserted into the user table. For example,</p>
<pre><code class="language-php"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'user1'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'username'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'lmayert'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'email'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'strosin.vernice@jerde.com'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'auth_key'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'K3nF70it7tzNsHddEiq0BZ0i-OU8S3xV'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'password'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'$2y$13$WSyE5hHsG1rWN2jV8LRHzubilrCLI5Ev/iK0r3jRuwQEs2ldRu.a2'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'user2'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'username'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'napoleon69'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'email'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'aileen.barton@heaneyschumm.com'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'auth_key'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'dZlXsVnIDgIzFgX4EduAqkEPuphhOh9q'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'password'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'$2y$13$kkgpvJ8lnjKo8RuoR30ay.RjDf15bMcHIF7Vz1zz/6viYG5xJExU6'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;],<br />];</span></code></pre>
<p>You may give an alias to a row so that later in your test, you may refer to the row via the alias. In the above example,
the two rows are aliased as <code>user1</code> and <code>user2</code>, respectively.</p>
<p>Also, you do not need to specify the data for auto-incremental columns. Yii will automatically fill the actual
values into the rows when the fixture is being loaded.</p>
<blockquote><p>Tip: You may customize the location of the data file by setting the <a href="./yii-test-activefixture.html#$dataFile-detail">yii\test\ActiveFixture::$dataFile</a> property.
You may also override <a href="./yii-test-activefixture.html#getData()-detail">yii\test\ActiveFixture::getData()</a> to provide the data.</p>
</blockquote>
<p>As we described earlier, a fixture may depend on other fixtures. For example, <code>UserProfileFixture</code> depends on <code>UserFixture</code>
because the user profile table contains a foreign key pointing to the user table.
The dependency is specified via the <a href="./yii-test-fixture.html#$depends-detail">yii\test\Fixture::$depends</a> property, like the following,</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">tests</span><span style="color: #007700">\</span><span style="color: #0000BB">fixtures</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">test</span><span style="color: #007700">\</span><span style="color: #0000BB">ActiveFixture</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">UserProfileFixture&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">ActiveFixture<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$modelClass&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'app\models\UserProfile'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$depends&nbsp;</span><span style="color: #007700">=&nbsp;[</span><span style="color: #DD0000">'app\tests\fixtures\UserFixture'</span><span style="color: #007700">];<br />}</span></code></pre>
<p>In the above, we have shown how to define a fixture about a DB table. To define a fixture not related with DB
(e.g. a fixture about certain files and directories), you may extend from the more general base class
<a href="./yii-test-fixture.html">yii\test\Fixture</a> and override the <a href="./yii-test-fixture.html#load()-detail">load()</a> and <a href="./yii-test-fixture.html#unload()-detail">unload()</a> methods.</p>
<h2>Using Fixtures <a href="#using-fixtures" name="using-fixtures" class="hashlink">&para;</a></h2><p>If you are using <a href="http://codeception.com/">CodeCeption</a> to test your code, you should consider using
the <code>yii2-codeception</code> extension which has the built-in support for loading and accessing fixtures.
If you are using other testing frameworks, you may use <a href="./yii-test-fixturetrait.html">yii\test\FixtureTrait</a> in your test cases
to achieve the same goal.</p>
<p>In the following we will describe how to write a <code>UserProfile</code> unit test class using <code>yii2-codeception</code>.</p>
<p>In your unit test class extending <a href="./yii-codeception-dbtestcase.html">yii\codeception\DbTestCase</a> or <a href="./yii-codeception-testcase.html">yii\codeception\TestCase</a>,
declare which fixtures you want to use in the <a href="./yii-test-fixturetrait.html#fixtures()-detail">fixtures()</a> method. For example,</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">tests</span><span style="color: #007700">\</span><span style="color: #0000BB">unit</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">codeception</span><span style="color: #007700">\</span><span style="color: #0000BB">DbTestCase</span><span style="color: #007700">;<br />use&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">tests</span><span style="color: #007700">\</span><span style="color: #0000BB">fixtures</span><span style="color: #007700">\</span><span style="color: #0000BB">UserProfileFixture</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">UserProfileTest&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">DbTestCase<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">fixtures</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'profiles'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">UserProfileFixture</span><span style="color: #007700">::</span><span style="color: #0000BB">className</span><span style="color: #007700">(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...test&nbsp;methods...<br /></span><span style="color: #007700">}</span></code></pre>
<p>The fixtures listed in the <code>fixtures()</code> method will be automatically loaded before running every test method
in the test case and unloaded after finishing every test method. And as we described before, when a fixture is
being loaded, all its dependent fixtures will be automatically loaded first. In the above example, because
<code>UserProfileFixture</code> depends on <code>UserFixture</code>, when running any test method in the test class,
two fixtures will be loaded sequentially: <code>UserFixture</code> and <code>UserProfileFixture</code>.</p>
<p>When specifying fixtures in <code>fixtures()</code>, you may use either a class name or a configuration array to refer to
a fixture. The configuration array will let you customize the fixture properties when the fixture is loaded.</p>
<p>You may also assign an alias to a fixture. In the above example, the <code>UserProfileFixture</code> is aliased as <code>profiles</code>.
In the test methods, you may then access a fixture object using its alias. For example, <code>$this-&gt;profiles</code> will
return the <code>UserProfileFixture</code> object.</p>
<p>Because <code>UserProfileFixture</code> extends from <code>ActiveFixture</code>, you may further use the following syntax to access
the data provided by the fixture:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #FF8000">//&nbsp;returns&nbsp;the&nbsp;data&nbsp;row&nbsp;aliased&nbsp;as&nbsp;'user1'<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">profiles</span><span style="color: #007700">[</span><span style="color: #DD0000">'user1'</span><span style="color: #007700">];<br /></span><span style="color: #FF8000">//&nbsp;returns&nbsp;the&nbsp;UserProfile&nbsp;model&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;data&nbsp;row&nbsp;aliased&nbsp;as&nbsp;'user1'<br /></span><span style="color: #0000BB">$profile&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">profiles</span><span style="color: #007700">(</span><span style="color: #DD0000">'user1'</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//&nbsp;traverse&nbsp;every&nbsp;data&nbsp;row&nbsp;in&nbsp;the&nbsp;fixture<br /></span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">profiles&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">)&nbsp;...</span></code></pre>
<blockquote><p>Info: <code>$this-&gt;profiles</code> is still of <code>UserProfileFixture</code> type. The above access features are implemented
through PHP magic methods.</p>
</blockquote>
<h2>Defining and Using Global Fixtures <a href="#defining-and-using-global-fixtures" name="defining-and-using-global-fixtures" class="hashlink">&para;</a></h2><p>The fixtures described above are mainly used by individual test cases. In most cases, you also need some global
fixtures that are applied to ALL or many test cases. An example is <a href="./yii-test-initdbfixture.html">yii\test\InitDbFixture</a> which does
two things:</p>
<ul>
<li>Perform some common initialization tasks by executing a script located at <code>@app/tests/fixtures/initdb.php</code>;</li>
<li>Disable the database integrity check before loading other DB fixtures, and re-enable it after other DB fixtures are unloaded.</li>
</ul>
<p>Using global fixtures is similar to using non-global ones. The only difference is that you declare these fixtures
in <a href="./yii-test-fixturetrait.html#globalFixtures()-detail">yii\codeception\TestCase::globalFixtures()</a> instead of <code>fixtures()</code>. When a test case loads fixtures, it will
first load global fixtures and then non-global ones.</p>
<p>By default, <a href="./yii-codeception-dbtestcase.html">yii\codeception\DbTestCase</a> already declares <code>InitDbFixture</code> in its <code>globalFixtures()</code> method.
This means you only need to work with <code>@app/tests/fixtures/initdb.php</code> if you want to do some initialization work
before each test. You may otherwise simply focus on developing each individual test case and the corresponding fixtures.</p>
<h2>Organizing Fixture Classes and Data Files <a href="#organizing-fixture-classes-and-data-files" name="organizing-fixture-classes-and-data-files" class="hashlink">&para;</a></h2><p>By default, fixture classes look for the corresponding data files under the <code>data</code> folder which is a sub-folder
of the folder containing the fixture class files. You can follow this convention when working with simple projects.
For big projects, chances are that you often need to switch different data files for the same fixture class for
different tests. We thus recommend that you organize the data files in a hierarchical way that is similar to
your class namespaces. For example,</p>
<pre><code># under folder tests\unit\fixtures

data\
    components\
        fixture_data_file1.php
        fixture_data_file2.php
        ...
        fixture_data_fileN.php
    models\
        fixture_data_file1.php
        fixture_data_file2.php
        ...
        fixture_data_fileN.php
# and so on
</code></pre>
<p>In this way you will avoid collision of fixture data files between tests and use them as you need.</p>
<blockquote><p>Note: In the example above fixture files are named only for example purpose. In real life you should name them
according to which fixture class your fixture classes are extending from. For example, if you are extending
from <a href="./yii-test-activefixture.html">yii\test\ActiveFixture</a> for DB fixtures, you should use DB table names as the fixture data file names;
If you are extending for <a href="./yii-mongodb-activefixture.html">yii\mongodb\ActiveFixture</a> for MongoDB fixtures, you should use collection names as the file names.</p>
</blockquote>
<p>The similar hierarchy can be used to organize fixture class files. Instead of using <code>data</code> as the root directory, you may
want to use <code>fixtures</code> as the root directory to avoid conflict with the data files.</p>
<h2>Summary <a href="#summary" name="summary" class="hashlink">&para;</a></h2><p>In the above, we have described how to define and use fixtures. Below we summarize the typical workflow
of running unit tests related with DB:</p>
<ol>
<li>Use <code>yii migrate</code> tool to upgrade your test database to the latest version;</li>
<li>Run a test case:<ul>
<li>Load fixtures: clean up the relevant DB tables and populate them with fixture data;</li>
<li>Perform the actual test;</li>
<li>Unload fixtures.</li>
</ul>
</li>
<li>Repeat Step 2 until all tests finish.</li>
</ol>
<p><strong>To be cleaned up below</strong></p>
<h1>Managing Fixtures <a href="#managing-fixtures" name="managing-fixtures" class="hashlink">&para;</a></h1><p>// todo: this tutorial may be merged into test-fixture.md</p>
<p>Fixtures are important part of testing. Their main purpose is to populate you with data that needed by testing
different cases. With this data using your tests becoming more efficient and useful.</p>
<p>Yii supports fixtures via the <code>yii fixture</code> command line tool. This tool supports:</p>
<ul>
<li>Loading fixtures to different storage such as: RDBMS, NoSQL, etc;</li>
<li>Unloading fixtures in different ways (usually it is clearing storage);</li>
<li>Auto-generating fixtures and populating it with random data.</li>
</ul>
<h2>Fixtures format <a href="#fixtures-format" name="fixtures-format" class="hashlink">&para;</a></h2><p>Fixtures are objects with different methods and configurations, refer to official <a href="https://github.com/yiisoft/yii2/blob/master/docs/guide/test-fixture.md">documentation</a> on them.
Lets assume we have fixtures data to load:</p>
<pre><code>#users.php file under fixtures data path, by default @tests\unit\fixtures\data

return [
    [
        'name' =&gt; 'Chase',
        'login' =&gt; 'lmayert',
        'email' =&gt; 'strosin.vernice@jerde.com',
        'auth_key' =&gt; 'K3nF70it7tzNsHddEiq0BZ0i-OU8S3xV',
        'password' =&gt; '$2y$13$WSyE5hHsG1rWN2jV8LRHzubilrCLI5Ev/iK0r3jRuwQEs2ldRu.a2',
    ],
    [
        'name' =&gt; 'Celestine',
        'login' =&gt; 'napoleon69',
        'email' =&gt; 'aileen.barton@heaneyschumm.com',
        'auth_key' =&gt; 'dZlXsVnIDgIzFgX4EduAqkEPuphhOh9q',
        'password' =&gt; '$2y$13$kkgpvJ8lnjKo8RuoR30ay.RjDf15bMcHIF7Vz1zz/6viYG5xJExU6',
    ],
];
</code></pre>
<p>If we are using fixture that loads data into database then these rows will be applied to <code>users</code> table. If we are using nosql fixtures, for example <code>mongodb</code>
fixture, then this data will be applied to <code>users</code> mongodb collection. In order to learn about implementing various loading strategies and more, refer to official <a href="https://github.com/yiisoft/yii2/blob/master/docs/guide/test-fixture.md">documentation</a>.
Above fixture example was auto-generated by <code>yii2-faker</code> extension, read more about it in these <a href="#auto-generating-fixtures">section</a>.
Fixture classes name should not be plural.</p>
<h2>Loading fixtures <a href="#loading-fixtures" name="loading-fixtures" class="hashlink">&para;</a></h2><p>Fixture classes should be suffixed by <code>Fixture</code> class. By default fixtures will be searched under <code>tests\unit\fixtures</code> namespace, you can
change this behavior with config or command options. Note that you can also append fixtures data to already existing ones with command
option <code>--append</code>. You can exclude some fixtures due load or unload by specifying <code>-</code> before its name like <code>-User</code>.</p>
<p>To load fixture, run the following command:</p>
<pre><code>yii fixture/load &lt;fixture_name&gt;
</code></pre>
<p>The required <code>fixture_name</code> parameter specifies a fixture name which data will be loaded. You can load several fixtures at once.
Below are correct formats of this command:</p>
<pre><code>// load `User` fixture
yii fixture/load User

// same as above, because default action of "fixture" command is "load"
yii fixture User

// load several fixtures
yii fixture User UserProfile

//load fixture, but don't clean storage before load and just append to already existed data
yii fixture User --append

// load all fixtures
yii fixture/load "*"

// same as above
yii fixture "*"

// load all fixtures except ones
yii fixture "*" -DoNotLoadThisOne

// load fixtures, but search them in different namespace. By default namespace is: tests\unit\fixtures.
yii fixture User --namespace='alias\my\custom\namespace'

// load global fixture `some\name\space\CustomFixture` before other fixtures will be loaded.
// By default this option is set to `InitDbFixture` to disable/enable integrity checks. You can specify several
// global fixtures separated by comma.
yii fixture User --globalFixtures='some\name\space\Custom'
</code></pre>
<h2>Unloading fixtures <a href="#unloading-fixtures" name="unloading-fixtures" class="hashlink">&para;</a></h2><p>To unload fixture, run the following command:</p>
<pre><code>// unload Users fixture, by default it will clear fixture storage (for example "users" table, or "users" collection if this is mongodb fixture).
yii fixture/unload User

// Unload several fixtures
yii fixture/unload User,UserProfile

// unload all fixtures
yii fixture/unload "*"

// unload all fixtures except ones
yii fixture/unload "*" -DoNotUnloadThisOne

</code></pre>
<p>Same command options like: <code>namespace</code>, <code>globalFixtures</code> also can be applied to this command.</p>
<h2>Configure Command Globally <a href="#configure-command-globally" name="configure-command-globally" class="hashlink">&para;</a></h2><p>While command line options allow us to configure the migration command
on-the-fly, sometimes we may want to configure the command once for all. For example you can configure
different migration path as follows:</p>
<pre><code>'controllerMap' =&gt; [
    'fixture' =&gt; [
        'class' =&gt; 'yii\console\controllers\FixtureController',
        'namespace' =&gt; 'myalias\some\custom\namespace',
        'globalFixtures' =&gt; [
            'some\name\space\Foo',
            'other\name\space\Bar'
        ],
    ],
]
</code></pre>
<h2>Auto-generating fixtures <a href="#auto-generating-fixtures" name="auto-generating-fixtures" class="hashlink">&para;</a></h2><p>Yii also can auto-generate fixtures for you based on some template. You can generate your fixtures with different data on different languages and formats.
These feature is done by <a href="https://github.com/fzaninotto/Faker">Faker</a> library and <code>yii2-faker</code> extension.
See extension <a href="https://github.com/yiisoft/yii2/tree/master/extensions/faker">guide</a> for more docs.</p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Fri, 24 Oct 2014 21:46:31 +0200</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// focus the search field
searchBox.focus();

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
