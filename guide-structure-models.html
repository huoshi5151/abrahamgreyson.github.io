<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/41d5631d/css/bootstrap.css" rel="stylesheet">
<link href="./assets/bad56eea/style.css" rel="stylesheet">
<script src="./assets/e17319cf/jquery.js"></script>
<script src="./assets/41d5631d/js/bootstrap.js"></script>
<script src="./assets/b52a7f0/jssearch.js"></script>    <title>Yii Framework 2.0 API Documentation</title>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-47725881-2', 'auto');
        ga('send', 'pageview');
</script><!--Google Analytics-->
</head>
<body>

<div class="wrap">
    <nav id="w1592" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w1592-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">Yii 2.0 API 文档</a></div><div id="w1592-collapse" class="collapse navbar-collapse"><ul id="w1593" class="navbar-nav nav"><li><a href="./index.html">类参考</a></li>
<li class="dropdown"><a class="dropdown-toggle" href="#" data-toggle="dropdown">扩展 <b class="caret"></b></a><ul id="w1594" class="dropdown-menu"><li><a href="./ext-apidoc-index.html" tabindex="-1">apidoc</a></li>
<li><a href="./ext-authclient-index.html" tabindex="-1">authclient</a></li>
<li><a href="./ext-bootstrap-index.html" tabindex="-1">bootstrap</a></li>
<li><a href="./ext-codeception-index.html" tabindex="-1">codeception</a></li>
<li><a href="./ext-composer-index.html" tabindex="-1">composer</a></li>
<li><a href="./ext-debug-index.html" tabindex="-1">debug</a></li>
<li><a href="./ext-elasticsearch-index.html" tabindex="-1">elasticsearch</a></li>
<li><a href="./ext-faker-index.html" tabindex="-1">faker</a></li>
<li><a href="./ext-gii-index.html" tabindex="-1">gii</a></li>
<li><a href="./ext-imagine-index.html" tabindex="-1">imagine</a></li>
<li><a href="./ext-jui-index.html" tabindex="-1">jui</a></li>
<li><a href="./ext-mongodb-index.html" tabindex="-1">mongodb</a></li>
<li><a href="./ext-redis-index.html" tabindex="-1">redis</a></li>
<li><a href="./ext-smarty-index.html" tabindex="-1">smarty</a></li>
<li><a href="./ext-sphinx-index.html" tabindex="-1">sphinx</a></li>
<li><a href="./ext-swiftmailer-index.html" tabindex="-1">swiftmailer</a></li>
<li><a href="./ext-twig-index.html" tabindex="-1">twig</a></li></ul></li>
<li><a href="./guide-README.html">权威指南</a></li>
<li class="dropdown"><a class="dropdown-toggle" href="#" data-toggle="dropdown">Github <b class="caret"></b></a><ul id="w1595" class="dropdown-menu"><li><a href="https://github.com/yiisoft/yii2" tabindex="-1">Yii 2.0</a></li>
<li><a href="https://github.com/yii2-chinesization/yii2-zh-cn" tabindex="-1">Yii 2.0 中文化项目</a></li>
<li><a href="https://github.com/AbrahamGreyson/abrahamgreyson.github.io" tabindex="-1">docwithcn.com</a></li>
<li><a href="https://github.com/AbrahamGreyson/abrahamgreyson.github.io/download/guide.pdf" tabindex="-1">下载 PDF</a></li></ul></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-1575" data-toggle="collapse" data-parent="#navigation">介绍 <b class="caret"></b></a><div id="navigation-1575" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-intro-yii.html">关于 Yii</a>
<a class="list-group-item" href="./guide-intro-upgrade-from-v1.html">从 Yii 1.1 升级</a></div>
<a class="list-group-item" href="#navigation-1576" data-toggle="collapse" data-parent="#navigation">入门 <b class="caret"></b></a><div id="navigation-1576" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-start-installation.html">安装 Yii</a>
<a class="list-group-item" href="./guide-start-workflow.html">运行应用</a>
<a class="list-group-item" href="./guide-start-hello.html">第一次问候</a>
<a class="list-group-item" href="./guide-start-forms.html">使用 Forms</a>
<a class="list-group-item" href="./guide-start-databases.html">玩转 Databases</a>
<a class="list-group-item" href="./guide-start-gii.html">用 Gii 生成代码</a>
<a class="list-group-item" href="./guide-start-looking-ahead.html">更上一层楼</a></div>
<a class="list-group-item active" href="#navigation-1577" data-toggle="collapse" data-parent="#navigation">应用结构 <b class="caret"></b></a><div id="navigation-1577" class="submenu panel-collapse collapse in"><a class="list-group-item" href="./guide-structure-overview.html">结构概述</a>
<a class="list-group-item" href="./guide-structure-entry-scripts.html">入口脚本</a>
<a class="list-group-item" href="./guide-structure-applications.html">应用</a>
<a class="list-group-item" href="./guide-structure-application-components.html">应用组件</a>
<a class="list-group-item" href="./guide-structure-controllers.html">控制器（Controller）</a>
<a class="list-group-item" href="./guide-structure-views.html">视图（View）</a>
<a class="list-group-item active" href="./guide-structure-models.html">模型（Model）</a>
<a class="list-group-item" href="./guide-structure-filters.html">过滤器</a>
<a class="list-group-item" href="./guide-structure-widgets.html">小部件（Widget）</a>
<a class="list-group-item" href="./guide-structure-modules.html">模块（Module）</a>
<a class="list-group-item" href="./guide-structure-assets.html">前端资源（Asset）</a>
<a class="list-group-item" href="./guide-structure-extensions.html">扩展（extensions）</a></div>
<a class="list-group-item" href="#navigation-1578" data-toggle="collapse" data-parent="#navigation">请求处理 <b class="caret"></b></a><div id="navigation-1578" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-runtime-overview.html">运行概述</a>
<a class="list-group-item" href="./guide-runtime-bootstrapping.html">引导（Bootstrapping）</a>
<a class="list-group-item" href="./guide-runtime-routing.html">路由（Routing）</a>
<a class="list-group-item" href="./guide-runtime-requests.html">请求（Request）</a>
<a class="list-group-item" href="./guide-runtime-responses.html">响应（Response）</a>
<a class="list-group-item" href="./guide-runtime-sessions-cookies.html">Sessions（会话）和 Cookies</a>
<a class="list-group-item" href="./guide-runtime-url-handling.html">URL 解析和生成</a>
<a class="list-group-item" href="./guide-runtime-handling-errors.html">错误处理</a>
<a class="list-group-item" href="./guide-runtime-logging.html">日志</a></div>
<a class="list-group-item" href="#navigation-1579" data-toggle="collapse" data-parent="#navigation">关键概念 <b class="caret"></b></a><div id="navigation-1579" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-concept-components.html">组件（Component）</a>
<a class="list-group-item" href="./guide-concept-properties.html">属性（Property）</a>
<a class="list-group-item" href="./guide-concept-events.html">事件（Event）</a>
<a class="list-group-item" href="./guide-concept-behaviors.html">行为（Behavior）</a>
<a class="list-group-item" href="./guide-concept-configurations.html">配置（Configurations）</a>
<a class="list-group-item" href="./guide-concept-autoloading.html">类自动加载（Autoloading）</a>
<a class="list-group-item" href="./guide-concept-alias.html">别名（Alias）</a>
<a class="list-group-item" href="./guide-concept-service-locator.html">服务定位器（Service Locator）</a>
<a class="list-group-item" href="./guide-concept-di-container.html">依赖注入容器（DI Container）</a></div>
<a class="list-group-item" href="#navigation-1580" data-toggle="collapse" data-parent="#navigation">配合数据库工作 <b class="caret"></b></a><div id="navigation-1580" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-db-dao.html">数据访问对象（DAO）</a>
<a class="list-group-item" href="./guide-db-query-builder.html">查询生成器（Query Builder）</a>
<a class="list-group-item" href="./guide-db-active-record.html">活动记录（Active Record）</a>
<a class="list-group-item" href="./guide-db-migrations.html">数据库迁移（Migration）</a>
<a class="list-group-item" href="./guide-db-sphinx.html">Sphinx</a>
<a class="list-group-item" href="./guide-db-redis.html">Redis</a>
<a class="list-group-item" href="./guide-db-mongodb.html">MongoDB</a>
<a class="list-group-item" href="./guide-db-elastic-search.html">ElasticSearch</a></div>
<a class="list-group-item" href="#navigation-1581" data-toggle="collapse" data-parent="#navigation">接收用户数据 <b class="caret"></b></a><div id="navigation-1581" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-input-forms.html">创建表单</a>
<a class="list-group-item" href="./guide-input-validation.html">输入验证</a>
<a class="list-group-item" href="./guide-input-file-uploading.html">文件上传</a>
<a class="list-group-item" href="./guide-input-multiple-models.html">多模型同时输入</a></div>
<a class="list-group-item" href="#navigation-1582" data-toggle="collapse" data-parent="#navigation">显示数据 <b class="caret"></b></a><div id="navigation-1582" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-output-formatter.html">格式化输出数据</a>
<a class="list-group-item" href="./guide-output-pagination.html">分页（Pagination）</a>
<a class="list-group-item" href="./guide-output-sorting.html">排序（Sorting）</a>
<a class="list-group-item" href="./guide-output-data-providers.html">数据提供器</a>
<a class="list-group-item" href="./guide-output-data-widgets.html">数据小部件</a>
<a class="list-group-item" href="./guide-output-theming.html">主题</a></div>
<a class="list-group-item" href="#navigation-1583" data-toggle="collapse" data-parent="#navigation">安全 <b class="caret"></b></a><div id="navigation-1583" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-security-authentication.html">认证（Authentication）</a>
<a class="list-group-item" href="./guide-security-authorization.html">授权（Authorization）</a>
<a class="list-group-item" href="./guide-security-passwords.html">处理密码</a>
<a class="list-group-item" href="./guide-security-auth-clients.html">客户端认证</a>
<a class="list-group-item" href="./guide-security-best-practices.html">安全领域的最佳实践</a></div>
<a class="list-group-item" href="#navigation-1584" data-toggle="collapse" data-parent="#navigation">缓存 <b class="caret"></b></a><div id="navigation-1584" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-caching-overview.html">概述</a>
<a class="list-group-item" href="./guide-caching-data.html">数据缓存</a>
<a class="list-group-item" href="./guide-caching-fragment.html">片段缓存</a>
<a class="list-group-item" href="./guide-caching-page.html">分页缓存</a>
<a class="list-group-item" href="./guide-caching-http.html">HTTP 缓存</a></div>
<a class="list-group-item" href="#navigation-1585" data-toggle="collapse" data-parent="#navigation">RESTful Web 服务 <b class="caret"></b></a><div id="navigation-1585" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-rest-quick-start.html">快速入门</a>
<a class="list-group-item" href="./guide-rest-resources.html">资源</a>
<a class="list-group-item" href="./guide-rest-routing.html">路由</a>
<a class="list-group-item" href="./guide-rest-response-formatting.html">格式化响应</a>
<a class="list-group-item" href="./guide-rest-authentication.html">授权验证</a>
<a class="list-group-item" href="./guide-rest-rate-limiting.html">速率限制</a>
<a class="list-group-item" href="./guide-rest-versioning.html">版本化</a>
<a class="list-group-item" href="./guide-rest-error-handling.html">错误处理</a>
<a class="list-group-item" href="./guide-rest-testing.html">测试</a></div>
<a class="list-group-item" href="#navigation-1586" data-toggle="collapse" data-parent="#navigation">开发工具 <b class="caret"></b></a><div id="navigation-1586" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-tool-debugger.html">调试工具栏和调试器</a>
<a class="list-group-item" href="./guide-tool-gii.html">使用 Gii 生成代码</a>
<a class="list-group-item" href="./guide-tool-api-doc.html">生成 API 文档</a></div>
<a class="list-group-item" href="#navigation-1587" data-toggle="collapse" data-parent="#navigation">测试 <b class="caret"></b></a><div id="navigation-1587" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-test-overview.html">概述</a>
<a class="list-group-item" href="./guide-test-endvironment-setup.html">搭建测试环境</a>
<a class="list-group-item" href="./guide-test-unit.html">单元测试</a>
<a class="list-group-item" href="./guide-test-functional.html">功能测试</a>
<a class="list-group-item" href="./guide-test-acceptance.html">验收测试</a>
<a class="list-group-item" href="./guide-test-fixtures.html">测试夹具</a></div>
<a class="list-group-item" href="#navigation-1588" data-toggle="collapse" data-parent="#navigation">高级专题 <b class="caret"></b></a><div id="navigation-1588" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-tutorial-advanced-app.html">高级应用模版</a>
<a class="list-group-item" href="./guide-tutorial-start-from-scratch.html">从头构建自定义模版</a>
<a class="list-group-item" href="./guide-tutorial-console.html">控制台命令</a>
<a class="list-group-item" href="./guide-tutorial-core-validators.html">核心验证器</a>
<a class="list-group-item" href="./guide-tutorial-i18n.html">国际化</a>
<a class="list-group-item" href="./guide-tutorial-mailing.html">收发邮件</a>
<a class="list-group-item" href="./guide-tutorial-performance-tuning.html">性能优化</a>
<a class="list-group-item" href="./guide-tutorial-shared-hosting.html">共享主机环境</a>
<a class="list-group-item" href="./guide-tutorial-template-engines.html">模板引擎</a>
<a class="list-group-item" href="./guide-tutorial-yii-integration.html">集成第三方代码</a></div>
<a class="list-group-item" href="#navigation-1589" data-toggle="collapse" data-parent="#navigation">小部件 <b class="caret"></b></a><div id="navigation-1589" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-widget-bootstrap.html">Bootstrap 小部件</a>
<a class="list-group-item" href="./guide-widget-jui.html">Jquery UI 小部件</a></div>
<a class="list-group-item" href="#navigation-1590" data-toggle="collapse" data-parent="#navigation">助手类 <b class="caret"></b></a><div id="navigation-1590" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-helper-overview.html">助手一览</a>
<a class="list-group-item" href="./guide-helper-array.html">ArrayHelper</a>
<a class="list-group-item" href="./guide-helper-html.html">Html</a>
<a class="list-group-item" href="./guide-helper-url.html">Url</a>
<a class="list-group-item" href="./guide-helper-security.html">security</a></div>
<a class="list-group-item" href="#navigation-1591" data-toggle="collapse" data-parent="#navigation">不在目录内的文件 <b class="caret"></b></a><div id="navigation-1591" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-glossary.html">glossary</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>模型 <a href="#" name="" class="hashlink">&para;</a></h1><p>模型是 <a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC</a> 模式中的一部分，
是代表业务数据、规则和逻辑的对象。</p>
<p>可通过继承 <a href="./yii-base-model.html">yii\base\Model</a> 或它的子类定义模型类，基类<a href="./yii-base-model.html">yii\base\Model</a>支持许多实用的特性：</p>
<ul>
<li><a href="#attributes">属性</a>: 代表可像普通类属性或数组一样被访问的业务数据;</li>
<li><a href="#attribute-labels">属性标签</a>: 指定属性显示出来的标签;</li>
<li><a href="#massive-assignment">块赋值</a>: 支持一步给许多属性赋值;</li>
<li><a href="#validation-rules">验证规则</a>: 确保输入数据符合所申明的验证规则;</li>
<li><a href="#data-exporting">数据导出</a>: 允许模型数据导出为自定义格式的数组。</li>
</ul>
<p><code>Model</code> 类也是更多高级模型如<a href="guide-db-active-record.html">Active Record 活动记录</a>的基类，
更多关于这些高级模型的详情请参考相关手册。</p>
<blockquote><p>补充：模型并不强制一定要继承<a href="./yii-base-model.html">yii\base\Model</a>，但是由于很多组件支持<a href="./yii-base-model.html">yii\base\Model</a>，最好使用它做为模型基类。</p>
</blockquote>
<h2>属性 <a name="attributes"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p>模型通过 <em>属性</em> 来代表业务数据，每个属性像是模型的公有可访问属性，
<a href="./yii-base-model.html#attributes()-detail">yii\base\Model::attributes()</a> 指定模型所拥有的属性。</p>
<p>可像访问一个对象属性一样访问模型的属性:</p>
<pre><code class="language-php"><span style="color: #0000BB">$model&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;\</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">\</span><span style="color: #0000BB">ContactForm</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;"name"&nbsp;是ContactForm模型的属性<br /></span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'example'</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">;</span></code></pre>
<p>也可像访问数组单元项一样访问属性，这要感谢<a href="./yii-base-model.html">yii\base\Model</a>支持 <a href="http://php.net/manual/en/class.arrayaccess.php">ArrayAccess 数组访问</a> 
和 <a href="http://php.net/manual/en/class.arrayiterator.php">ArrayIterator 数组迭代器</a>:</p>
<pre><code class="language-php"><span style="color: #0000BB">$model&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;\</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">\</span><span style="color: #0000BB">ContactForm</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;像访问数组单元项一样访问属性<br /></span><span style="color: #0000BB">$model</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'example'</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">$model</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">];<br /><br /></span><span style="color: #FF8000">//&nbsp;迭代器遍历模型<br /></span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$model&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$name</span><span style="color: #DD0000">:&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />}</span></code></pre>
<h3>定义属性 <a name="defining-attributes"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>默认情况下你的模型类直接从<a href="./yii-base-model.html">yii\base\Model</a>继承，所有 <em>non-static public非静态公有</em> 成员变量都是属性。
例如，下述<code>ContactForm</code> 模型类有四个属性<code>name</code>, <code>email</code>, <code>subject</code> and <code>body</code>，
<code>ContactForm</code> 模型用来代表从HTML表单获取的输入数据。</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">base</span><span style="color: #007700">\</span><span style="color: #0000BB">Model</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">ContactForm&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">Model<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$name</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$email</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$subject</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$body</span><span style="color: #007700">;<br />}</span></code></pre>
<p>另一种方式是可覆盖 <a href="./yii-base-model.html#attributes()-detail">yii\base\Model::attributes()</a> 来定义属性，该方法返回模型的属性名。
例如 <a href="./yii-db-activerecord.html">yii\db\ActiveRecord</a> 返回对应数据表列名作为它的属性名，
注意可能需要覆盖魔术方法如<code>__get()</code>, <code>__set()</code>使属性像普通对象属性被访问。</p>
<h3>属性标签 <a name="attribute-labels"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>当属性显示或获取输入时，经常要显示属性相关标签，例如假定一个属性名为<code>firstName</code>，
在某些地方如表单输入或错误信息处，你可能想显示对终端用户来说更友好的 <code>First Name</code> 标签。</p>
<p>可以调用 <a href="./yii-base-model.html#getAttributeLabel()-detail">yii\base\Model::getAttributeLabel()</a> 获取属性的标签，例如：</p>
<pre><code class="language-php"><span style="color: #0000BB">$model&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;\</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">\</span><span style="color: #0000BB">ContactForm</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;显示为&nbsp;"Name"<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getAttributeLabel</span><span style="color: #007700">(</span><span style="color: #DD0000">'name'</span><span style="color: #007700">);</span></code></pre>
<p>默认情况下，属性标签通过<a href="./yii-base-model.html#generateAttributeLabel()-detail">yii\base\Model::generateAttributeLabel()</a>方法自动从属性名生成. 
它会自动将驼峰式大小写变量名转换为多个首字母大写的单词，例如 <code>username</code> 转换为 <code>Username</code>，
<code>firstName</code> 转换为 <code>First Name</code>。</p>
<p>如果你不想用自动生成的标签，可以覆盖 <a href="./yii-base-model.html#attributeLabels()-detail">yii\base\Model::attributeLabels()</a> 方法明确指定属性标签，例如：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">base</span><span style="color: #007700">\</span><span style="color: #0000BB">Model</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">ContactForm&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">Model<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$name</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$email</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$subject</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$body</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">attributeLabels</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'name'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'Your&nbsp;name'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'email'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'Your&nbsp;email&nbsp;address'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'subject'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'Subject'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'body'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'Content'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}</span></code></pre>
<p>应用支持多语言的情况下，可翻译属性标签，
可在 <a href="./yii-base-model.html#attributeLabels()-detail">attributeLabels()</a> 方法中定义，如下所示:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">attributeLabels</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'name'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;\</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'app'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Your&nbsp;name'</span><span style="color: #007700">),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'email'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;\</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'app'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Your&nbsp;email&nbsp;address'</span><span style="color: #007700">),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'subject'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;\</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'app'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Subject'</span><span style="color: #007700">),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'body'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;\</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">t</span><span style="color: #007700">(</span><span style="color: #DD0000">'app'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Content'</span><span style="color: #007700">),<br />&nbsp;&nbsp;&nbsp;&nbsp;];<br />}</span></code></pre>
<p>甚至可以根据条件定义标签，例如通过使用模型的 <a href="#scenarios">scenario场景</a>，
可对相同的属性返回不同的标签。</p>
<blockquote><p>补充：属性标签是 <a href="guide-structure-views.html">视图</a>一部分，但是在模型中申明标签通常非常方便，并可行程非常简洁可重用代码。</p>
</blockquote>
<h2>场景 <a name="scenarios"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p>模型可能在多个 <em>场景</em> 下使用，例如 <code>User</code> 模块可能会在收集用户登录输入，也可能会在用户注册时使用。
在不同的场景下，模型可能会使用不同的业务规则和逻辑，例如 <code>email</code> 属性在注册时强制要求有，但在登陆时不需要。</p>
<p>模型使用 <a href="./yii-base-model.html#$scenario-detail">yii\base\Model::$scenario</a> 属性保持使用场景的跟踪，
默认情况下，模型支持一个名为 <code>default</code> 的场景，如下展示两种设置场景的方法:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #FF8000">//&nbsp;场景作为属性来设置<br /></span><span style="color: #0000BB">$model&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">User</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">scenario&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'login'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;场景通过构造初始化配置来设置<br /></span><span style="color: #0000BB">$model&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">User</span><span style="color: #007700">([</span><span style="color: #DD0000">'scenario'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'login'</span><span style="color: #007700">]);</span></code></pre>
<p>默认情况下，模型支持的场景由模型中申明的 <a href="#validation-rules">验证规则</a> 来决定，
但你可以通过覆盖<a href="./yii-base-model.html#scenarios()-detail">yii\base\Model::scenarios()</a>方法来自定义行为，如下所示：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">db</span><span style="color: #007700">\</span><span style="color: #0000BB">ActiveRecord</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">User&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">ActiveRecord<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">scenarios</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'login'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'register'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}</span></code></pre>
<blockquote><p>补充：在上述和下述的例子中，模型类都是继承<a href="./yii-db-activerecord.html">yii\db\ActiveRecord</a>，
  因为多场景的使用通常发生在<a href="guide-db-active-record.html">Active Record</a> 类中.</p>
</blockquote>
<p><code>scenarios()</code> 方法返回一个数组，数组的键为场景名，值为对应的 <em>active attributes活动属性</em>。
活动属性可被 <a href="#massive-assignment">块赋值</a> 并遵循<a href="#validation-rules">验证规则</a>
在上述例子中，<code>username</code> 和 <code>password</code> 在<code>login</code>场景中启用，在 <code>register</code> 场景中, 
除了 <code>username</code> and <code>password</code> 外 <code>email</code> 也被启用。</p>
<p><code>scenarios()</code> 方法默认实现会返回所有<a href="./yii-base-model.html#rules()-detail">yii\base\Model::rules()</a>方法申明的验证规则中的场景，
当覆盖<code>scenarios()</code>时，如果你想在默认场景外使用新场景，可以编写类似如下代码：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">db</span><span style="color: #007700">\</span><span style="color: #0000BB">ActiveRecord</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">User&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">ActiveRecord<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">scenarios</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$scenarios&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parent</span><span style="color: #007700">::</span><span style="color: #0000BB">scenarios</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$scenarios</span><span style="color: #007700">[</span><span style="color: #DD0000">'login'</span><span style="color: #007700">]&nbsp;=&nbsp;[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$scenarios</span><span style="color: #007700">[</span><span style="color: #DD0000">'register'</span><span style="color: #007700">]&nbsp;=&nbsp;[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$scenarios</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}</span></code></pre>
<p>场景特性主要在<a href="#validation-rules">验证</a> 和 <a href="#massive-assignment">属性块赋值</a> 中使用。
你也可以用于其他目的，例如可基于不同的场景定义不同的 <a href="#attribute-labels">属性标签</a>。</p>
<h2>验证规则 <a name="validation-rules"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p>当模型接收到终端用户输入的数据，数据应当满足某种规则(称为 <em>验证规则</em>, 也称为 <em>业务规则</em>)。
例如假定<code>ContactForm</code>模型，你可能想确保所有属性不为空且 <code>email</code> 属性包含一个有效的邮箱地址，
如果某个属性的值不满足对应的业务规则，相应的错误信息应显示，以帮助用户修正错误。</p>
<p>可调用 <a href="./yii-base-model.html#validate()-detail">yii\base\Model::validate()</a> 来验证接收到的数据，
该方法使用<a href="./yii-base-model.html#rules()-detail">yii\base\Model::rules()</a>申明的验证规则来验证每个相关属性，
如果没有找到错误，会返回 true，否则它会将错误保存在 <a href="./yii-base-model.html#$errors-detail">yii\base\Model::$errors</a> 属性中并返回false，例如：</p>
<pre><code class="language-php"><span style="color: #0000BB">$model&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;\</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">\</span><span style="color: #0000BB">ContactForm</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;用户输入数据赋值到模型属性<br /></span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">attributes&nbsp;</span><span style="color: #007700">=&nbsp;\</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">post</span><span style="color: #007700">(</span><span style="color: #DD0000">'ContactForm'</span><span style="color: #007700">);<br /><br />if&nbsp;(</span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">validate</span><span style="color: #007700">())&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;所有输入数据都有效&nbsp;all&nbsp;inputs&nbsp;are&nbsp;valid<br /></span><span style="color: #007700">}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;验证失败：$errors&nbsp;是一个包含错误信息的数组<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$errors&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">errors</span><span style="color: #007700">;<br />}</span></code></pre>
<p>通过覆盖 <a href="./yii-base-model.html#rules()-detail">yii\base\Model::rules()</a> 方法指定模型属性应该满足的规则来申明模型相关验证规则。
下述例子显示<code>ContactForm</code>模型申明的验证规则:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">rules</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;name,&nbsp;email,&nbsp;subject&nbsp;和&nbsp;body&nbsp;属性必须有值<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">[[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'subject'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'body'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'required'</span><span style="color: #007700">],<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;email&nbsp;属性必须是一个有效的电子邮箱地址<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">[</span><span style="color: #DD0000">'email'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">],<br />&nbsp;&nbsp;&nbsp;&nbsp;];<br />}</span></code></pre>
<p>一条规则可用来验证一个或多个属性，一个属性可对应一条或多条规则。
更多关于如何申明验证规则的详情请参考 <a href="guide-input-validation.html">验证输入</a> 一节.</p>
<p>有时你想一条规则只在某个 <a href="#scenarios">场景</a> 下应用，为此你可以指定规则的 <code>on</code> 属性，如下所示:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">rules</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;在"register"&nbsp;场景下&nbsp;username,&nbsp;email&nbsp;和&nbsp;password&nbsp;必须有值<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">[[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'required'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'on'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'register'</span><span style="color: #007700">],<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;在&nbsp;"login"&nbsp;场景下&nbsp;username&nbsp;和&nbsp;password&nbsp;必须有值<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">[[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'required'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'on'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'login'</span><span style="color: #007700">],<br />&nbsp;&nbsp;&nbsp;&nbsp;];<br />}</span></code></pre>
<p>如果没有指定 <code>on</code> 属性，规则会在所有场景下应用， 在当前<a href="./yii-base-model.html#$scenario-detail">scenario</a>
下应用的规则称之为 <em>active rule活动规则</em>。</p>
<p>一个属性只会属于<code>scenarios()</code>中定义的活动属性且在<code>rules()</code>申明对应一条或多条活动规则的情况下被验证。</p>
<h2>块赋值 <a name="massive-assignment"></a> <a href="#" name="" class="hashlink">&para;</a></h2><h2>Massive Assignment <a name="massive-assignment"></a> <a href="#massive-assignment" name="massive-assignment" class="hashlink">&para;</a></h2><p>块赋值只用一行代码将用户所有输入填充到一个模型，非常方便，
它直接将输入数据对应填充到 <a href="./yii-base-model.html#attributes()-detail">yii\base\Model::attributes()</a> 属性。
以下两段代码效果是相同的，都是将终端用户输入的表单数据赋值到 <code>ContactForm</code> 模型的属性，
明显地前一段块赋值的代码比后一段代码简洁且不易出错。</p>
<pre><code class="language-php"><span style="color: #0000BB">$model&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;\</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">\</span><span style="color: #0000BB">ContactForm</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">attributes&nbsp;</span><span style="color: #007700">=&nbsp;\</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">post</span><span style="color: #007700">(</span><span style="color: #DD0000">'ContactForm'</span><span style="color: #007700">);</span></code></pre>
<pre><code class="language-php"><span style="color: #0000BB">$model&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;\</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">\</span><span style="color: #0000BB">ContactForm</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">=&nbsp;\</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">request</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">post</span><span style="color: #007700">(</span><span style="color: #DD0000">'ContactForm'</span><span style="color: #007700">,&nbsp;[]);<br /></span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name&nbsp;</span><span style="color: #007700">=&nbsp;isset(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">])&nbsp;?&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'name'</span><span style="color: #007700">]&nbsp;:&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">email&nbsp;</span><span style="color: #007700">=&nbsp;isset(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'email'</span><span style="color: #007700">])&nbsp;?&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'email'</span><span style="color: #007700">]&nbsp;:&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">subject&nbsp;</span><span style="color: #007700">=&nbsp;isset(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'subject'</span><span style="color: #007700">])&nbsp;?&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'subject'</span><span style="color: #007700">]&nbsp;:&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">body&nbsp;</span><span style="color: #007700">=&nbsp;isset(</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'body'</span><span style="color: #007700">])&nbsp;?&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">[</span><span style="color: #DD0000">'body'</span><span style="color: #007700">]&nbsp;:&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;</span></code></pre>
<h3>安全属性 <a name="safe-attributes"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>块赋值只应用在模型当前<a href="./yii-base-model.html#$scenario-detail">scenario</a>场景<a href="./yii-base-model.html#scenarios()-detail">yii\base\Model::scenarios()</a>方法
列出的称之为 <em>安全属性</em> 的属性上，例如，如果<code>User</code>模型申明以下场景，
当当前场景为<code>login</code>时候，只有<code>username</code> and <code>password</code> 可被块赋值，其他属性不会被赋值。</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">scenarios</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'login'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'register'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'email'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">],<br />&nbsp;&nbsp;&nbsp;&nbsp;];<br />}</span></code></pre>
<blockquote><p>补充: 块赋值只应用在安全属性上，因为你想控制哪些属性会被终端用户输入数据所修改，
  例如，如果 <code>User</code> 模型有一个<code>permission</code>属性对应用户的权限，
  你可能只想让这个属性在后台界面被管理员修改。</p>
</blockquote>
<p>由于默认<a href="./yii-base-model.html#scenarios()-detail">yii\base\Model::scenarios()</a>的实现会返回<a href="./yii-base-model.html#rules()-detail">yii\base\Model::rules()</a>所有属性和数据，
如果不覆盖这个方法，表示所有只要出现在活动验证规则中的属性都是安全的。</p>
<p>为此，提供一个特别的别名为 <code>safe</code> 的验证器来申明哪些属性是安全的不需要被验证，
如下示例的规则申明 <code>title</code> 和 <code>description</code> 都为安全属性。</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">rules</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[[</span><span style="color: #DD0000">'title'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'description'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'safe'</span><span style="color: #007700">],<br />&nbsp;&nbsp;&nbsp;&nbsp;];<br />}</span></code></pre>
<h3>非安全属性 <a name="unsafe-attributes"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>如上所述，<a href="./yii-base-model.html#scenarios()-detail">yii\base\Model::scenarios()</a> 方法提供两个用处：定义哪些属性应被验证，定义哪些属性安全。
在某些情况下，你可能想验证一个属性但不想让他是安全的，可在<code>scenarios()</code>方法中属性名加一个惊叹号 <code>!</code>。
例如像如下的<code>secret</code>属性。</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">scenarios</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'login'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'!secret'</span><span style="color: #007700">],<br />&nbsp;&nbsp;&nbsp;&nbsp;];<br />}</span></code></pre>
<p>当模型在 <code>login</code> 场景下，三个属性都会被验证，但只有 <code>username</code>和 <code>password</code> 属性会被块赋值，
要对<code>secret</code>属性赋值，必须像如下例子明确对它赋值。</p>
<pre><code class="language-php"><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">secret&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$secret</span><span style="color: #007700">;</span></code></pre>
<h2>数据导出 <a name="data-exporting"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p>模型通常要导出成不同格式，例如，你可能想将模型的一个集合转成JSON或Excel格式，
导出过程可分解为两个步骤，第一步，模型转换成数组；第二步，数组转换成所需要的格式。
你只需要关注第一步，因为第二步可被通用的数据转换器如<a href="./yii-web-jsonresponseformatter.html">yii\web\JsonResponseFormatter</a>来完成。</p>
<p>将模型转换为数组最简单的方式是使用 <a href="./yii-base-model.html#attributes()-detail">yii\base\Model::attributes()</a> 属性，例如：</p>
<pre><code class="language-php"><span style="color: #0000BB">$post&nbsp;</span><span style="color: #007700">=&nbsp;\</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">\</span><span style="color: #0000BB">Post</span><span style="color: #007700">::</span><span style="color: #0000BB">findOne</span><span style="color: #007700">(</span><span style="color: #0000BB">100</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$array&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$post</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">attributes</span><span style="color: #007700">;</span></code></pre>
<p><a href="./yii-base-model.html#attributes()-detail">yii\base\Model::attributes()</a> 属性会返回 <em>所有</em> <a href="./yii-base-model.html#attributes()-detail">yii\base\Model::attributes()</a> 申明的属性的值。</p>
<p>更灵活和强大的将模型转换为数组的方式是使用 <a href="./yii-base-arrayabletrait.html#toArray()-detail">yii\base\Model::toArray()</a> 方法，
它的行为默认和 <a href="./yii-base-model.html#attributes()-detail">yii\base\Model::attributes()</a> 相同，
但是它允许你选择哪些称之为<em>字段</em>的数据项放入到结果数组中并同时被格式化。
实际上，它是导出模型到 RESTful 网页服务开发的默认方法，详情请参阅<a href="guide-rest-response-formatting.html">响应格式</a>.</p>
<h3>字段 <a name="fields"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>字段是模型通过调用<a href="./yii-base-arrayabletrait.html#toArray()-detail">yii\base\Model::toArray()</a>生成的数组的单元名。</p>
<p>默认情况下，字段名对应属性名，但是你可以通过覆盖
<a href="./yii-base-model.html#fields()-detail">fields()</a> 和/或 <a href="./yii-base-arrayabletrait.html#extraFields()-detail">extraFields()</a> 方法来改变这种行为，
两个方法都返回一个字段定义列表，<code>fields()</code> 方法定义的字段是默认字段，表示<code>toArray()</code>方法默认会返回这些字段。 
<code>extraFields()</code>方法定义额外可用字段，通过<code>toArray()</code>方法指定<code>$expand</code>参数来返回这些额外可用字段。
例如如下代码会返回<code>fields()</code>方法定义的所有字段和<code>extraFields()</code>方法定义的<code>prettyName</code> and <code>fullAddress</code>字段。</p>
<pre><code class="language-php"><span style="color: #0000BB">$array&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$model</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">toArray</span><span style="color: #007700">([],&nbsp;[</span><span style="color: #DD0000">'prettyName'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'fullAddress'</span><span style="color: #007700">]);</span></code></pre>
<p>可通过覆盖 <code>fields()</code> 来增加、删除、重命名和重定义字段，<code>fields()</code> 方法返回值应为数组，
数组的键为字段名，数组的值为对应的可为属性名或匿名函数返回的字段定义对应的值。
特使情况下，如果字段名和属性定义名相同，可以省略数组键，例如：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #FF8000">//&nbsp;明确列出每个字段，特别用于你想确保数据表或模型属性改变不会导致你的字段改变(保证后端的API兼容).<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">fields</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;字段名和属性名相同<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'id'</span><span style="color: #007700">,<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;字段名为&nbsp;"email"，对应属性名为&nbsp;"email_address"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'email'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'email_address'</span><span style="color: #007700">,<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;字段名为&nbsp;"name",&nbsp;值通过PHP代码返回<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'name'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;function&nbsp;()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">first_name&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">last_name</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br />&nbsp;&nbsp;&nbsp;&nbsp;];<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;过滤掉一些字段，特别用于你想继承父类实现并不想用一些敏感字段<br /></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">fields</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$fields&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parent</span><span style="color: #007700">::</span><span style="color: #0000BB">fields</span><span style="color: #007700">();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;去掉一些包含敏感信息的字段<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">unset(</span><span style="color: #0000BB">$fields</span><span style="color: #007700">[</span><span style="color: #DD0000">'auth_key'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$fields</span><span style="color: #007700">[</span><span style="color: #DD0000">'password_hash'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$fields</span><span style="color: #007700">[</span><span style="color: #DD0000">'password_reset_token'</span><span style="color: #007700">]);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$fields</span><span style="color: #007700">;<br />}</span></code></pre>
<blockquote><p>警告：由于模型的所有属性会被包含在导出数组，最好检查数据确保没包含敏感数据，
如果有敏感数据，应覆盖 <code>fields()</code> 方法过滤掉，在上述列子中，我们选择过滤掉
<code>auth_key</code>, <code>password_hash</code> and <code>password_reset_token</code>。</p>
</blockquote>
<h2>最佳实践 <a name="best-practices"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p>模型是代表业务数据、规则和逻辑的中心地方，通常在很多地方重用，
在一个设计良好的应用中，模型通常比<a href="guide-structure-controllers.html">控制器</a>代码多。</p>
<p>归纳起来，模型</p>
<ul>
<li>可包含属性来展示业务数据;</li>
<li>可包含验证规则确保数据有效和完整;</li>
<li>可包含方法实现业务逻辑;</li>
<li>不应直接访问请求，session和其他环境数据，这些数据应该由<a href="guide-structure-controllers.html">控制器</a>传入到模型;</li>
<li>应避免嵌入HTML或其他展示代码，这些代码最好在 <a href="guide-structure-views.html">视图</a>中处理;</li>
<li>单个模型中避免太多的 <a href="#scenarios">场景</a>.</li>
</ul>
<p>在开发大型复杂系统时应经常考虑最后一条建议，
在这些系统中，模型会很大并在很多地方使用，因此会包含需要规则集和业务逻辑，
最后维护这些模型代码成为一个噩梦，因为一个简单修改会影响好多地方，
为确保模型好维护，最好使用以下策略：</p>
<ul>
<li>定义可被多个 <a href="guide-structure-applications.html">应用主体</a> 或 <a href="guide-structure-modules.html">模块</a> 共享的模型基类集合。
这些模型类应包含通用的最小规则集合和逻辑。</li>
<li>在每个使用模型的 <a href="guide-structure-applications.html">应用主体</a> 或 <a href="guide-structure-modules.html">模块</a>中，
通过继承对应的模型基类来定义具体的模型类，具体模型类包含应用主体或模块指定的规则和逻辑。</li>
</ul>
<p>例如，在<a href="guide-tutorial-advanced-app.html">高级应用模板</a>，你可以定义一个模型基类<code>common\models\Post</code>，
然后在前台应用中，定义并使用一个继承<code>common\models\Post</code>的具体模型类<code>frontend\models\Post</code>，
在后台应用中可以类似地定义<code>backend\models\Post</code>。
通过这种策略，你清楚<code>frontend\models\Post</code>只对应前台应用，如果你修改它，就无需担忧修改会影响后台应用。</p>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Sun, 26 Oct 2014 20:43:18 +0100</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// focus the search field
searchBox.focus();

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
