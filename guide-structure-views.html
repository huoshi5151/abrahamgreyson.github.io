<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="language" content="en" />
        <link href="./assets/41d5631d/css/bootstrap.css" rel="stylesheet">
<link href="./assets/bad56eea/style.css" rel="stylesheet">
<script src="./assets/e17319cf/jquery.js"></script>
<script src="./assets/41d5631d/js/bootstrap.js"></script>
<script src="./assets/b52a7f0/jssearch.js"></script>    <title>Yii Framework 2.0 API Documentation</title>
</head>
<body>

<div class="wrap">
    <nav id="w1655" class="navbar-inverse navbar-fixed-top navbar" role="navigation"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#w1655-collapse"><span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span></button><a class="navbar-brand" href="./index.html">Yii 2.0 API 文档</a></div><div id="w1655-collapse" class="collapse navbar-collapse"><ul id="w1656" class="navbar-nav nav"><li><a href="./index.html">类参考</a></li>
<li class="dropdown"><a class="dropdown-toggle" href="#" data-toggle="dropdown">扩展 <b class="caret"></b></a><ul id="w1657" class="dropdown-menu"><li><a href="./ext-apidoc-index.html" tabindex="-1">apidoc</a></li>
<li><a href="./ext-authclient-index.html" tabindex="-1">authclient</a></li>
<li><a href="./ext-bootstrap-index.html" tabindex="-1">bootstrap</a></li>
<li><a href="./ext-codeception-index.html" tabindex="-1">codeception</a></li>
<li><a href="./ext-composer-index.html" tabindex="-1">composer</a></li>
<li><a href="./ext-debug-index.html" tabindex="-1">debug</a></li>
<li><a href="./ext-elasticsearch-index.html" tabindex="-1">elasticsearch</a></li>
<li><a href="./ext-faker-index.html" tabindex="-1">faker</a></li>
<li><a href="./ext-gii-index.html" tabindex="-1">gii</a></li>
<li><a href="./ext-imagine-index.html" tabindex="-1">imagine</a></li>
<li><a href="./ext-jui-index.html" tabindex="-1">jui</a></li>
<li><a href="./ext-mongodb-index.html" tabindex="-1">mongodb</a></li>
<li><a href="./ext-redis-index.html" tabindex="-1">redis</a></li>
<li><a href="./ext-smarty-index.html" tabindex="-1">smarty</a></li>
<li><a href="./ext-sphinx-index.html" tabindex="-1">sphinx</a></li>
<li><a href="./ext-swiftmailer-index.html" tabindex="-1">swiftmailer</a></li>
<li><a href="./ext-twig-index.html" tabindex="-1">twig</a></li></ul></li>
<li><a href="./guide-README.html">权威指南</a></li>
<li class="dropdown"><a class="dropdown-toggle" href="#" data-toggle="dropdown">Github <b class="caret"></b></a><ul id="w1658" class="dropdown-menu"><li><a href="https://github.com/yiisoft/yii2" tabindex="-1">Yii 2.0</a></li>
<li><a href="https://github.com/yii2-chinesization/yii2-zh-cn" tabindex="-1">Yii 2.0 中文化项目</a></li>
<li><a href="https://github.com/AbrahamGreyson/abrahamgreyson.github.io" tabindex="-1">docwithcn.com</a></li>
<li><a href="https://github.com/AbrahamGreyson/abrahamgreyson.github.io/download/guide.pdf" tabindex="-1">下载 PDF</a></li></ul></li></ul><div class="navbar-form navbar-left" role="search">
  <div class="form-group">
    <input id="searchbox" type="text" class="form-control" placeholder="Search">
  </div>
</div>
</div></nav>
    <div id="search-resultbox" style="display: none;" class="modal-content">
        <ul id="search-results">
        </ul>
    </div>

    
<div class="row">
    <div class="col-md-2">
                <div id="navigation" class="list-group"><a class="list-group-item" href="#navigation-1638" data-toggle="collapse" data-parent="#navigation">介绍 <b class="caret"></b></a><div id="navigation-1638" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-intro-yii.html">关于 Yii</a>
<a class="list-group-item" href="./guide-intro-upgrade-from-v1.html">从 Yii 1.1 升级</a></div>
<a class="list-group-item" href="#navigation-1639" data-toggle="collapse" data-parent="#navigation">入门 <b class="caret"></b></a><div id="navigation-1639" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-start-installation.html">安装 Yii</a>
<a class="list-group-item" href="./guide-start-workflow.html">运行应用</a>
<a class="list-group-item" href="./guide-start-hello.html">第一次问候</a>
<a class="list-group-item" href="./guide-start-forms.html">使用 Forms</a>
<a class="list-group-item" href="./guide-start-databases.html">玩转 Databases</a>
<a class="list-group-item" href="./guide-start-gii.html">用 Gii 生成代码</a>
<a class="list-group-item" href="./guide-start-looking-ahead.html">更上一层楼</a></div>
<a class="list-group-item active" href="#navigation-1640" data-toggle="collapse" data-parent="#navigation">应用结构 <b class="caret"></b></a><div id="navigation-1640" class="submenu panel-collapse collapse in"><a class="list-group-item" href="./guide-structure-overview.html">结构概述</a>
<a class="list-group-item" href="./guide-structure-entry-scripts.html">入口脚本</a>
<a class="list-group-item" href="./guide-structure-applications.html">应用</a>
<a class="list-group-item" href="./guide-structure-application-components.html">应用组件</a>
<a class="list-group-item" href="./guide-structure-controllers.html">控制器（Controller）</a>
<a class="list-group-item active" href="./guide-structure-views.html">视图（View）</a>
<a class="list-group-item" href="./guide-structure-models.html">模型（Model）</a>
<a class="list-group-item" href="./guide-structure-filters.html">过滤器</a>
<a class="list-group-item" href="./guide-structure-widgets.html">小部件（Widget）</a>
<a class="list-group-item" href="./guide-structure-modules.html">模块（Module）</a>
<a class="list-group-item" href="./guide-structure-assets.html">前端资源（Asset）</a>
<a class="list-group-item" href="./guide-structure-extensions.html">扩展（extensions）</a></div>
<a class="list-group-item" href="#navigation-1641" data-toggle="collapse" data-parent="#navigation">请求处理 <b class="caret"></b></a><div id="navigation-1641" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-runtime-overview.html">运行概述</a>
<a class="list-group-item" href="./guide-runtime-bootstrapping.html">引导（Bootstrapping）</a>
<a class="list-group-item" href="./guide-runtime-routing.html">路由（Routing）</a>
<a class="list-group-item" href="./guide-runtime-requests.html">请求（Request）</a>
<a class="list-group-item" href="./guide-runtime-responses.html">响应（Response）</a>
<a class="list-group-item" href="./guide-runtime-sessions-cookies.html">Sessions（会话）和 Cookies</a>
<a class="list-group-item" href="./guide-runtime-url-handling.html">URL 解析和生成</a>
<a class="list-group-item" href="./guide-runtime-handling-errors.html">错误处理</a>
<a class="list-group-item" href="./guide-runtime-logging.html">日志</a></div>
<a class="list-group-item" href="#navigation-1642" data-toggle="collapse" data-parent="#navigation">关键概念 <b class="caret"></b></a><div id="navigation-1642" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-concept-components.html">组件（Component）</a>
<a class="list-group-item" href="./guide-concept-properties.html">属性（Property）</a>
<a class="list-group-item" href="./guide-concept-events.html">事件（Event）</a>
<a class="list-group-item" href="./guide-concept-behaviors.html">行为（Behavior）</a>
<a class="list-group-item" href="./guide-concept-configurations.html">配置（Configurations）</a>
<a class="list-group-item" href="./guide-concept-autoloading.html">类自动加载（Autoloading）</a>
<a class="list-group-item" href="./guide-concept-alias.html">别名（Alias）</a>
<a class="list-group-item" href="./guide-concept-service-locator.html">服务定位器（Service Locator）</a>
<a class="list-group-item" href="./guide-concept-di-container.html">依赖注入容器（DI Container）</a></div>
<a class="list-group-item" href="#navigation-1643" data-toggle="collapse" data-parent="#navigation">配合数据库工作 <b class="caret"></b></a><div id="navigation-1643" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-db-dao.html">数据访问对象（DAO）</a>
<a class="list-group-item" href="./guide-db-query-builder.html">查询生成器（Query Builder）</a>
<a class="list-group-item" href="./guide-db-active-record.html">活动记录（Active Record）</a>
<a class="list-group-item" href="./guide-db-migrations.html">数据库迁移（Migration）</a>
<a class="list-group-item" href="./guide-db-sphinx.html">Sphinx</a>
<a class="list-group-item" href="./guide-db-redis.html">Redis</a>
<a class="list-group-item" href="./guide-db-mongodb.html">MongoDB</a>
<a class="list-group-item" href="./guide-db-elastic-search.html">ElasticSearch</a></div>
<a class="list-group-item" href="#navigation-1644" data-toggle="collapse" data-parent="#navigation">接收用户数据 <b class="caret"></b></a><div id="navigation-1644" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-input-forms.html">创建表单</a>
<a class="list-group-item" href="./guide-input-validation.html">输入验证</a>
<a class="list-group-item" href="./guide-input-file-uploading.html">文件上传</a>
<a class="list-group-item" href="./guide-input-multiple-models.html">多模型同时输入</a></div>
<a class="list-group-item" href="#navigation-1645" data-toggle="collapse" data-parent="#navigation">显示数据 <b class="caret"></b></a><div id="navigation-1645" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-output-formatter.html">格式化输出数据</a>
<a class="list-group-item" href="./guide-output-pagination.html">分页（Pagination）</a>
<a class="list-group-item" href="./guide-output-sorting.html">排序（Sorting）</a>
<a class="list-group-item" href="./guide-output-data-providers.html">数据提供器</a>
<a class="list-group-item" href="./guide-output-data-widgets.html">数据小部件</a>
<a class="list-group-item" href="./guide-output-theming.html">主题</a></div>
<a class="list-group-item" href="#navigation-1646" data-toggle="collapse" data-parent="#navigation">安全 <b class="caret"></b></a><div id="navigation-1646" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-security-authentication.html">认证（Authentication）</a>
<a class="list-group-item" href="./guide-security-authorization.html">授权（Authorization）</a>
<a class="list-group-item" href="./guide-security-passwords.html">处理密码</a>
<a class="list-group-item" href="./guide-security-auth-clients.html">客户端认证</a>
<a class="list-group-item" href="./guide-security-best-practices.html">安全领域的最佳实践</a></div>
<a class="list-group-item" href="#navigation-1647" data-toggle="collapse" data-parent="#navigation">缓存 <b class="caret"></b></a><div id="navigation-1647" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-caching-overview.html">概述</a>
<a class="list-group-item" href="./guide-caching-data.html">数据缓存</a>
<a class="list-group-item" href="./guide-caching-fragment.html">片段缓存</a>
<a class="list-group-item" href="./guide-caching-page.html">分页缓存</a>
<a class="list-group-item" href="./guide-caching-http.html">HTTP 缓存</a></div>
<a class="list-group-item" href="#navigation-1648" data-toggle="collapse" data-parent="#navigation">RESTful Web 服务 <b class="caret"></b></a><div id="navigation-1648" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-rest-quick-start.html">快速入门</a>
<a class="list-group-item" href="./guide-rest-resources.html">资源</a>
<a class="list-group-item" href="./guide-rest-routing.html">路由</a>
<a class="list-group-item" href="./guide-rest-response-formatting.html">格式化响应</a>
<a class="list-group-item" href="./guide-rest-authentication.html">授权验证</a>
<a class="list-group-item" href="./guide-rest-rate-limiting.html">速率限制</a>
<a class="list-group-item" href="./guide-rest-versioning.html">版本化</a>
<a class="list-group-item" href="./guide-rest-error-handling.html">错误处理</a>
<a class="list-group-item" href="./guide-rest-testing.html">测试</a></div>
<a class="list-group-item" href="#navigation-1649" data-toggle="collapse" data-parent="#navigation">开发工具 <b class="caret"></b></a><div id="navigation-1649" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-tool-debugger.html">调试工具栏和调试器</a>
<a class="list-group-item" href="./guide-tool-gii.html">使用 Gii 生成代码</a>
<a class="list-group-item" href="./guide-tool-api-doc.html">生成 API 文档</a></div>
<a class="list-group-item" href="#navigation-1650" data-toggle="collapse" data-parent="#navigation">测试 <b class="caret"></b></a><div id="navigation-1650" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-test-overview.html">概述</a>
<a class="list-group-item" href="./guide-test-endvironment-setup.html">搭建测试环境</a>
<a class="list-group-item" href="./guide-test-unit.html">单元测试</a>
<a class="list-group-item" href="./guide-test-functional.html">功能测试</a>
<a class="list-group-item" href="./guide-test-acceptance.html">验收测试</a>
<a class="list-group-item" href="./guide-test-fixtures.html">测试夹具</a></div>
<a class="list-group-item" href="#navigation-1651" data-toggle="collapse" data-parent="#navigation">高级专题 <b class="caret"></b></a><div id="navigation-1651" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-tutorial-advanced-app.html">高级应用模版</a>
<a class="list-group-item" href="./guide-tutorial-start-from-scratch.html">从头构建自定义模版</a>
<a class="list-group-item" href="./guide-tutorial-console.html">控制台命令</a>
<a class="list-group-item" href="./guide-tutorial-core-validators.html">核心验证器</a>
<a class="list-group-item" href="./guide-tutorial-i18n.html">国际化</a>
<a class="list-group-item" href="./guide-tutorial-mailing.html">收发邮件</a>
<a class="list-group-item" href="./guide-tutorial-performance-tuning.html">性能优化</a>
<a class="list-group-item" href="./guide-tutorial-shared-hosting.html">共享主机环境</a>
<a class="list-group-item" href="./guide-tutorial-template-engines.html">模板引擎</a>
<a class="list-group-item" href="./guide-tutorial-yii-integration.html">集成第三方代码</a></div>
<a class="list-group-item" href="#navigation-1652" data-toggle="collapse" data-parent="#navigation">小部件 <b class="caret"></b></a><div id="navigation-1652" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-widget-bootstrap.html">Bootstrap 小部件</a>
<a class="list-group-item" href="./guide-widget-jui.html">Jquery UI 小部件</a></div>
<a class="list-group-item" href="#navigation-1653" data-toggle="collapse" data-parent="#navigation">助手类 <b class="caret"></b></a><div id="navigation-1653" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-helper-overview.html">助手一览</a>
<a class="list-group-item" href="./guide-helper-array.html">ArrayHelper</a>
<a class="list-group-item" href="./guide-helper-html.html">Html</a>
<a class="list-group-item" href="./guide-helper-url.html">Url</a>
<a class="list-group-item" href="./guide-helper-security.html">security</a></div>
<a class="list-group-item" href="#navigation-1654" data-toggle="collapse" data-parent="#navigation">不在目录内的文件 <b class="caret"></b></a><div id="navigation-1654" class="submenu panel-collapse collapse"><a class="list-group-item" href="./guide-glossary.html">glossary</a></div></div>    </div>
    <div class="col-md-9 guide-content" role="main">
        <h1>视图 <a href="#" name="" class="hashlink">&para;</a></h1><p>视图是 <a href="http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC</a> 模式中的一部分。
它是展示数据到终端用户的代码，在网页应用中，根据<em>视图模板</em>来创建视图，视图模板为PHP脚本文件，
主要包含HTML代码和展示类PHP代码，通过<a href="./yii-web-view.html">view</a>应用组件来管理，
该组件主要提供通用方法帮助视图构造和渲染，简单起见，我们称视图模板或视图模板文件为视图。</p>
<h2>创建视图 <a name="creating-views"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p>如前所述，视图为包含HTML和PHP代码的PHP脚本，如下代码为一个登录表单的视图，
可看到PHP代码用来生成动态内容如页面标题和表单，HTML代码把它组织成一个漂亮的HTML页面。</p>
<pre><code class="language-php"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">helpers</span><span style="color: #007700">\</span><span style="color: #0000BB">Html</span><span style="color: #007700">;<br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">widgets</span><span style="color: #007700">\</span><span style="color: #0000BB">ActiveForm</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;@var&nbsp;$this&nbsp;yii\web\View&nbsp;*/<br />/*&nbsp;@var&nbsp;$form&nbsp;yii\widgets\ActiveForm&nbsp;*/<br />/*&nbsp;@var&nbsp;$model&nbsp;app\models\LoginForm&nbsp;*/<br /><br /></span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">title&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'Login'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;<br /></span>&lt;h1&gt;<span style="color: #0000BB">&lt;?=&nbsp;Html</span><span style="color: #007700">::</span><span style="color: #0000BB">encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">title</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/h1&gt;<br /><br />&lt;p&gt;Please&nbsp;fill&nbsp;out&nbsp;the&nbsp;following&nbsp;fields&nbsp;to&nbsp;login:&lt;/p&gt;<br /><br /><span style="color: #0000BB">&lt;?php&nbsp;$form&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ActiveForm</span><span style="color: #007700">::</span><span style="color: #0000BB">begin</span><span style="color: #007700">();&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?=&nbsp;$form</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">field</span><span style="color: #007700">(</span><span style="color: #0000BB">$model</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'username'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?=&nbsp;$form</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">field</span><span style="color: #007700">(</span><span style="color: #0000BB">$model</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">)-&gt;</span><span style="color: #0000BB">passwordInput</span><span style="color: #007700">()&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?=&nbsp;Html</span><span style="color: #007700">::</span><span style="color: #0000BB">submitButton</span><span style="color: #007700">(</span><span style="color: #DD0000">'Login'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;<br />&lt;?php&nbsp;ActiveForm</span><span style="color: #007700">::</span><span style="color: #0000BB">end</span><span style="color: #007700">();&nbsp;</span><span style="color: #0000BB">?&gt;</span></code></pre>
<p>在视图中，可访问 <code>$this</code> 指向 <a href="./yii-web-view.html">view component</a> 来管理和渲染这个视图文件。</p>
<p>除了 <code>$this</code>之外，上述示例中的视图有其他预定义变量如 <code>$model</code>，
这些变量代表从<a href="guide-structure-controllers.html">控制器</a>或其他触发<a href="#rendering-views">视图渲染</a>的对象 <em>传入</em> 到视图的数据。</p>
<blockquote><p>技巧: 将预定义变量列到视图文件头部注释处，这样可被IDE编辑器识别，也是生成视图文档的好方法。</p>
</blockquote>
<h3>安全 <a name="security"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>当创建生成HTML页面的视图时，在显示之前将用户输入数据进行转码和过滤非常重要，
否则，你的应用可能会被<a href="http://en.wikipedia.org/wiki/Cross-site_scripting">跨站脚本</a> 攻击。</p>
<p>要显示纯文本，先调用 <a href="./yii-helpers-basehtml.html#encode()-detail">yii\helpers\Html::encode()</a> 进行转码，例如如下代码将用户名在显示前先转码：</p>
<pre><code class="language-php"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">helpers</span><span style="color: #007700">\</span><span style="color: #0000BB">Html</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;<br /></span><br />&lt;div&nbsp;class="username"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?=&nbsp;Html</span><span style="color: #007700">::</span><span style="color: #0000BB">encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">name</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&lt;/div&gt</code></pre>
<p>要显示HTML内容，先调用 <a href="./yii-helpers-htmlpurifier.html">yii\helpers\HtmlPurifier</a> 过滤内容，例如如下代码将提交内容在显示前先过滤：</p>
<pre><code class="language-php"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">helpers</span><span style="color: #007700">\</span><span style="color: #0000BB">HtmlPurifier</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;<br /></span><br />&lt;div&nbsp;class="post"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?=&nbsp;HtmlPurifier</span><span style="color: #007700">::</span><span style="color: #0000BB">process</span><span style="color: #007700">(</span><span style="color: #0000BB">$post</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">text</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&lt;/div&gt</code></pre>
<blockquote><p>技巧：HTMLPurifier在保证输出数据安全上做的不错，但性能不佳，如果你的应用需要高性能可考虑
  <a href="guide-caching-overview.html">缓存</a> 过滤后的结果。</p>
</blockquote>
<h3>组织视图 <a name="organizing-views"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>与 <a href="guide-structure-controllers.html">控制器</a> 和 <a href="guide-structure-models.html">模型</a> 类似，在组织视图上有一些约定：</p>
<ul>
<li>控制器渲染的视图文件默认放在 <code>@app/views/ControllerID</code> 目录下，
其中 <code>ControllerID</code> 对应 <a href="guide-structure-controllers.html#routes">控制器 ID</a>,
例如控制器类为 <code>PostController</code>，视图文件目录应为 <code>@app/views/post</code>，
控制器类 <code>PostCommentController</code>对应的目录为 <code>@app/views/post-comment</code>，
如果是模块中的控制器，目录应为 <a href="./yii-base-module.html#$basePath-detail">module directory</a> 模块目录下的 <code>views/ControllerID</code> 目录；</li>
<li>对于 <a href="guide-structure-widgets.html">小部件</a> 渲染的视图文件默认放在 <code>WidgetPath/views</code> 目录，
其中 <code>WidgetPath</code> 代表小部件类文件所在的目录；</li>
<li>对于其他对象渲染的视图文件，建议遵循和小部件相似的规则。</li>
</ul>
<p>可覆盖控制器或小部件的 <a href="./yii-base-viewcontextinterface.html#getViewPath()-detail">yii\base\ViewContextInterface::getViewPath()</a> 方法来自定义视图文件默认目录。</p>
<h2>渲染视图 <a name="rendering-views"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p>可在 <a href="guide-structure-controllers.html">控制器</a>, <a href="guide-structure-widgets.html">小部件</a>, 或其他地方调用渲染视图方法来渲染视图，
该方法类似以下格式：</p>
<pre><code>/**
 * @param string $view 视图名或文件路径，由实际的渲染方法决定
 * @param array $params 传递给视图的数据
 * @return string 渲染结果
 */
methodName($view, $params = [])
</code></pre>
<h3>控制器中渲染 <a name="rendering-in-controllers"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>在 <a href="guide-structure-controllers.html">控制器</a> 中，可调用以下控制器方法来渲染视图：</p>
<ul>
<li><a href="./yii-base-controller.html#render()-detail">render()</a>: 渲染一个 <a href="#named-views">视图名</a> 并使用一个 <a href="#layouts">布局</a>
返回到渲染结果。</li>
<li><a href="./yii-base-controller.html#renderPartial()-detail">renderPartial()</a>: 渲染一个 <a href="#named-views">视图名</a> 并且不使用布局。</li>
<li><a href="./yii-web-controller.html#renderAjax()-detail">renderAjax()</a>: 渲染一个 <a href="#named-views">视图名</a> 并且不使用布局，
并注入所有注册的JS/CSS脚本和文件，通常使用在响应AJAX网页请求的情况下。</li>
<li></li>
</ul>
<p>例如：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">controllers</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">Yii</span><span style="color: #007700">;<br />use&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">models</span><span style="color: #007700">\</span><span style="color: #0000BB">Post</span><span style="color: #007700">;<br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">web</span><span style="color: #007700">\</span><span style="color: #0000BB">Controller</span><span style="color: #007700">;<br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">web</span><span style="color: #007700">\</span><span style="color: #0000BB">NotFoundHttpException</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">PostController&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">Controller<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">actionView</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$model&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">Post</span><span style="color: #007700">::</span><span style="color: #0000BB">findOne</span><span style="color: #007700">(</span><span style="color: #0000BB">$id</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$model&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;</span><span style="color: #0000BB">NotFoundHttpException</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;渲染一个名称为"view"的视图并使用布局<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">render</span><span style="color: #007700">(</span><span style="color: #DD0000">'view'</span><span style="color: #007700">,&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'model'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$model</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}</span></code></pre>
<h3>小部件中渲染 <a name="rendering-in-widgets"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>在 <a href="guide-structure-widgets.html">小部件</a> 中，可调用以下小部件方法来渲染视图：
Within <a href="guide-structure-widgets.html">widgets</a>, you may call the following widget methods to render views.</p>
<ul>
<li><a href="./yii-base-widget.html#render()-detail">render()</a>: 渲染一个 <a href="#named-views">视图名</a>.</li>
<li></li>
</ul>
<p>例如：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">components</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">base</span><span style="color: #007700">\</span><span style="color: #0000BB">Widget</span><span style="color: #007700">;<br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">helpers</span><span style="color: #007700">\</span><span style="color: #0000BB">Html</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">ListWidget&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">Widget<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$items&nbsp;</span><span style="color: #007700">=&nbsp;[];<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">run</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;渲染一个名为&nbsp;"list"&nbsp;的视图<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">render</span><span style="color: #007700">(</span><span style="color: #DD0000">'list'</span><span style="color: #007700">,&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'items'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">items</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}</span></code></pre>
<h3>视图中渲染 <a name="rendering-in-views"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>可以在视图中渲染另一个视图，可以调用<a href="./yii-base-view.html">view component</a>视图组件提供的以下方法：</p>
<ul>
<li><a href="./yii-base-view.html#render()-detail">render()</a>: 渲染一个 <a href="#named-views">视图名</a>.</li>
<li><a href="./yii-web-view.html#renderAjax()-detail">renderAjax()</a>: 渲染一个 <a href="#named-views">视图名</a>
并注入所有注册的JS/CSS脚本和文件，通常使用在响应AJAX网页请求的情况下。</li>
<li></li>
</ul>
<p>例如，视图中的如下代码会渲染该视图所在目录下的 <code>_overview.php</code> 视图文件，
记住视图中 <code>$this</code> 对应 <a href="./yii-base-view.html">view</a> 组件:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">&lt;?=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">render</span><span style="color: #007700">(</span><span style="color: #DD0000">'_overview'</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span></code></pre>
<h3>其他地方渲染 <a name="rendering-in-other-places"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>在任何地方都可以通过表达式 <code>Yii::$app-&gt;view</code> 访问 <a href="./yii-base-view.html">view</a> 应用组件，
调用它的如前所述的方法渲染视图，例如：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #FF8000">//&nbsp;显示视图文件&nbsp;"@app/views/site/license.php"<br /></span><span style="color: #007700">echo&nbsp;\</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">view</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">renderFile</span><span style="color: #007700">(</span><span style="color: #DD0000">'@app/views/site/license.php'</span><span style="color: #007700">);</span></code></pre>
<h3>视图名 <a name="named-views"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>渲染视图时，可指定一个视图名或视图文件路径/别名，大多数情况下使用前者因为前者简洁灵活，
我们称用名字的视图为 <em>视图名</em>.</p>
<p>视图名可以依据以下规则到对应的视图文件路径：</p>
<ul>
<li>视图名可省略文件扩展名，这种情况下使用 <code>.php</code> 作为扩展，
视图名 <code>about</code> 对应到 <code>about.php</code> 文件名；</li>
<li>视图名以双斜杠 <code>//</code> 开头，对应的视图文件路径为 <code>@app/views/ViewName</code>，
也就是说视图文件在 <a href="./yii-base-application.html#$viewPath-detail">application's view path</a> 路径下找，
例如 <code>//site/about</code> 对应到 <code>@app/views/site/about.php</code>。</li>
<li>视图名以单斜杠<code>/</code>开始，视图文件路径以当前使用<a href="guide-structure-modules.html">模块</a> 的<a href="./yii-base-module.html#$viewPath-detail">view path</a>开始，
如果不存在模块，使用<code>@app/views/ViewName</code>开始，例如，如果当前模块为<code>user</code>， <code>/user/create</code> 对应成
<code>@app/modules/user/views/user/create.php</code>, 如果在模块中，<code>/user/create</code>对应<code>@app/views/user/create.php</code>。</li>
<li>如果 <a href="./yii-base-view.html#$context-detail">context</a> 渲染视图 并且上下文实现了 <a href="./yii-base-viewcontextinterface.html">yii\base\ViewContextInterface</a>,
视图文件路径由上下文的 <a href="./yii-base-viewcontextinterface.html#getViewPath()-detail">view path</a> 开始，
这种主要用在控制器和小部件中渲染视图，例如
如果上下文为控制器<code>SiteController</code>，<code>site/about</code> 对应到 <code>@app/views/site/about.php</code>。</li>
<li>如果视图渲染另一个视图，包含另一个视图文件的目录以当前视图的文件路径开始，
例如被视图<code>@app/views/post/index.php</code> 渲染的 <code>item</code> 对应到 <code>@app/views/post/item</code>。</li>
</ul>
<p>根据以上规则，在控制器中 <code>app\controllers\PostController</code> 调用 <code>$this-&gt;render('view')</code>，
实际上渲染 <code>@app/views/post/view.php</code> 视图文件，当在该视图文件中调用 <code>$this-&gt;render('_overview')</code>
会渲染 <code>@app/views/post/_overview.php</code> 视图文件。</p>
<h3>视图中访问数据 <a name="accessing-data-in-views"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>在视图中有两种方式访问数据：推送和拉取。</p>
<p>推送方式是通过视图渲染方法的第二个参数传递数据，数据格式应为名称-值的数组，
视图渲染时，调用PHP <code>extract()</code> 方法将该数组转换为视图可访问的变量。
例如，如下控制器的渲染视图代码推送2个变量到 <code>report</code> 视图：<code>$foo = 1</code> 和 <code>$bar = 2</code>。</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">render</span><span style="color: #007700">(</span><span style="color: #DD0000">'report'</span><span style="color: #007700">,&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'foo'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'bar'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,<br />]);</span></code></pre>
<p>拉取方式可让视图从<a href="./yii-base-view.html">view component</a>视图组件或其他对象中主动获得数据(如<code>Yii::$app</code>)，
在视图中使用如下表达式<code>$this-&gt;context</code>可获取到控制器ID，
可让你在<code>report</code>视图中获取控制器的任意属性或方法，如以下代码获取控制器ID。</p>
<pre><code class="language-php"><span style="color: #0000BB">The&nbsp;controller&nbsp;ID&nbsp;is</span><span style="color: #007700">:&nbsp;&lt;?=&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">context</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">id&nbsp;?&gt;<br /></span>?&gt</code></pre>
<p>推送方式让视图更少依赖上下文对象，是视图获取数据优先使用方式，
缺点是需要手动构建数组，有些繁琐，在不同地方渲染时容易出错。</p>
<h3>视图间共享数据 <a name="sharing-data-among-views"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p><a href="./yii-base-view.html">view component</a>视图组件提供<a href="./yii-base-view.html#$params-detail">params</a>参数属性来让不同视图共享数据。</p>
<p>例如在<code>about</code>视图中，可使用如下代码指定当前breadcrumbs的当前部分。</p>
<pre><code class="language-php"><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">params</span><span style="color: #007700">[</span><span style="color: #DD0000">'breadcrumbs'</span><span style="color: #007700">][]&nbsp;=&nbsp;</span><span style="color: #DD0000">'About&nbsp;Us'</span><span style="color: #007700">;</span></code></pre>
<p>在<a href="#layouts">布局</a>文件（也是一个视图）中，可使用依次加入到<a href="./yii-base-view.html#$params-detail">params</a>数组的值来
生成显示breadcrumbs:</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">&lt;?=&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">widgets</span><span style="color: #007700">\</span><span style="color: #0000BB">Breadcrumbs</span><span style="color: #007700">::</span><span style="color: #0000BB">widget</span><span style="color: #007700">([<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'links'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">params</span><span style="color: #007700">[</span><span style="color: #DD0000">'breadcrumbs'</span><span style="color: #007700">])&nbsp;?&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">params</span><span style="color: #007700">[</span><span style="color: #DD0000">'breadcrumbs'</span><span style="color: #007700">]&nbsp;:&nbsp;[],<br />])&nbsp;</span><span style="color: #0000BB">?&gt;</span></code></pre>
<h2>布局 <a name="layouts"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p>布局是一种特殊的视图，代表多个视图的公共部分，例如，大多数Web应用共享相同的页头和页尾，
在每个视图中重复相同的页头和页尾，更好的方式是将这些公共放到一个布局中，
渲染内容视图后在合适的地方嵌入到布局中。</p>
<h3>创建布局 <a name="creating-layouts"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>由于布局也是视图，它可像普通视图一样创建，布局默认存储在<code>@app/views/layouts</code>路径下，
<a href="guide-structure-modules.html">模块</a>中使用的布局应存储在<a href="./yii-base-module.html#$basePath-detail">module directory</a>模块目录
下的<code>views/layouts</code>路径下，可配置<a href="./yii-base-module.html#$layoutPath-detail">yii\base\Module::$layoutPath</a>来自定义应用或模块的布局默认路径。</p>
<p>如下示例为一个布局大致内容，注意作为示例，简化了很多代码，
在实际中，你可能想添加更多内容，如头部标签，主菜单等。</p>
<pre><code class="language-php"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">helpers</span><span style="color: #007700">\</span><span style="color: #0000BB">Html</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">/*&nbsp;@var&nbsp;$this&nbsp;yii\web\View&nbsp;*/<br />/*&nbsp;@var&nbsp;$content&nbsp;string&nbsp;字符串&nbsp;*/<br /></span><span style="color: #0000BB">?&gt;<br />&lt;?php&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">beginPage</span><span style="color: #007700">()&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&lt;!DOCTYPE&nbsp;html&gt;<br />&lt;html&nbsp;lang="en"&gt;<br />&lt;head&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;charset="UTF-8"/&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?=&nbsp;Html</span><span style="color: #007700">::</span><span style="color: #0000BB">csrfMetaTags</span><span style="color: #007700">()&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;<span style="color: #0000BB">&lt;?=&nbsp;Html</span><span style="color: #007700">::</span><span style="color: #0000BB">encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">title</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/title&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">head</span><span style="color: #007700">()&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&lt;/head&gt;<br />&lt;body&gt;<br /><span style="color: #0000BB">&lt;?php&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">beginBody</span><span style="color: #007700">()&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;header&gt;My&nbsp;Company&lt;/header&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?=&nbsp;$content&nbsp;?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;footer&gt;&amp;copy;&nbsp;2014&nbsp;by&nbsp;My&nbsp;Company&lt;/footer&gt;<br /><span style="color: #0000BB">&lt;?php&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">endBody</span><span style="color: #007700">()&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&lt;/body&gt;<br />&lt;/html&gt;<br /><span style="color: #0000BB">&lt;?php&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">endPage</span><span style="color: #007700">()&nbsp;</span><span style="color: #0000BB">?&gt;</span></code></pre>
<p>如上所示，布局生成每个页面通用的HTML标签，在<code>&lt;body&gt;</code>标签中，打印<code>$content</code>变量，
<code>$content</code>变量代表当<a href="./yii-base-controller.html#render()-detail">yii\base\Controller::render()</a>控制器渲染方法调用时传递到布局的内容视图渲染结果。</p>
<p>大多数视图应调用上述代码中的如下方法，这些方法触发关于渲染过程的事件，
这样其他地方注册的脚本和标签会添加到这些方法调用的地方。</p>
<ul>
<li><p>它触发表明页面开始的 <a href="./yii-base-view.html#EVENT_BEGIN_PAGE-detail">EVENT_BEGIN_PAGE</a> 事件。</p>
</li>
<li><p>它触发表明页面结尾的 <a href="./yii-base-view.html#EVENT_END_PAGE-detail">EVENT_END_PAGE</a> 时间。</p>
</li>
<li><p>它生成一个占位符，在页面渲染结束时会被注册的头部HTML代码（如，link标签, meta标签）替换。</p>
</li>
<li><p>它触发 <a href="./yii-web-view.html#EVENT_BEGIN_BODY-detail">EVENT_BEGIN_BODY</a> 事件并生成一个占位符，
会被注册的HTML代码（如JavaScript）在页面主体开始处替换。</p>
</li>
<li><p>它触发 <a href="./yii-web-view.html#EVENT_END_BODY-detail">EVENT_END_BODY</a> 事件并生成一个占位符，
会被注册的HTML代码（如JavaScript）在页面主体结尾处替换。</p>
</li>
</ul>
<h3>布局中访问数据 <a name="accessing-data-in-layouts"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>在布局中可访问两个预定义变量：<code>$this</code> 和 <code>$content</code>，前者对应和普通视图类似的<a href="./yii-base-view.html">view</a> 视图组件
后者包含调用<a href="./yii-base-controller.html#render()-detail">render()</a>方法渲染内容视图的结果。</p>
<p>如果想在布局中访问其他数据，必须使用<a href="#accessing-data-in-views">视图中访问数据</a>一节介绍的拉取方式，
如果想从内容视图中传递数据到布局，可使用<a href="#sharing-data-among-views">视图间共享数据</a>一节中的方法。</p>
<h3>使用布局 <a name="using-layouts"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>如<a href="#rendering-in-controllers">控制器中渲染</a>一节描述，当控制器调用<a href="./yii-base-controller.html#render()-detail">render()</a>
方法渲染视图时，会同时使用布局到渲染结果中，默认会使用<code>@app/views/layouts/main.php</code>布局文件。</p>
<p>可配置<a href="./yii-base-application.html#$layout-detail">yii\base\Application::$layout</a> 或 <a href="./yii-base-controller.html#$layout-detail">yii\base\Controller::$layout</a> 使用其他布局文件，
前者管理所有控制器的布局，后者覆盖前者来控制单个控制器布局。
例如，如下代码使 <code>post</code> 控制器渲染视图时使用 <code>@app/views/layouts/post.php</code> 作为布局文件，
假如 <code>layout</code> 属性没改变，控制器默认使用 <code>@app/views/layouts/main.php</code> 作为布局文件。</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">controllers</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">web</span><span style="color: #007700">\</span><span style="color: #0000BB">Controller</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">PostController&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">Controller<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$layout&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'post'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...<br /></span><span style="color: #007700">}</span></code></pre>
<p>对于模块中的控制器，可配置模块的 <a href="./yii-base-module.html#$layout-detail">layout</a> 属性指定布局文件应用到模块的所有控制器。</p>
<p>由于<code>layout</code> 可在不同层级（控制器、模块，应用）配置，在幕后Yii使用两步来决定控制器实际使用的布局。</p>
<p>第一步，它决定布局的值和上下文模块：</p>
<ul>
<li>如果控制器的 <a href="./yii-base-controller.html#$layout-detail">yii\base\Controller::$layout</a> 属性不为空null，使用它作为布局的值，
控制器的 <a href="./yii-base-controller.html#$module-detail">module</a>模块 作为上下文模块。</li>
<li>如果 <a href="./yii-base-controller.html#$layout-detail">layout</a> 为空，从控制器的祖先模块（包括应用） 开始找
第一个<a href="./yii-base-module.html#$layout-detail">layout</a> 属性不为空的模块，使用该模块作为上下文模块，
并将它的<a href="./yii-base-module.html#$layout-detail">layout</a> 的值作为布局的值，
如果都没有找到，表示不使用布局。</li>
</ul>
<p>第二步，它决定第一步中布局的值和上下文模块对应到实际的布局文件，布局的值可为：</p>
<ul>
<li>路径别名 (如 <code>@app/views/layouts/main</code>).</li>
<li>绝对路径 (如 <code>/main</code>): 布局的值以斜杠开始，在应用的[[yii\base\Application::layoutPath|layout path] 布局路径
中查找实际的布局文件，布局路径默认为 <code>@app/views/layouts</code>。</li>
<li>相对路径 (如 <code>main</code>): 在上下文模块的<a href="./yii-base-module.html#$layoutPath-detail">layout path</a>布局路径中查找实际的布局文件，
布局路径默认为<a href="./yii-base-module.html#$basePath-detail">module directory</a>模块目录下的<code>views/layouts</code> 目录。</li>
<li>布尔值 <code>false</code>: 不使用布局。</li>
</ul>
<p>布局的值没有包含文件扩展名，默认使用 <code>.php</code>作为扩展名。</p>
<h3>嵌套布局 <a name="nested-layouts"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>有时候你想嵌套一个布局到另一个，例如，在Web站点不同地方，想使用不同的布局，
同时这些布局共享相同的生成全局HTML5页面结构的基本布局，可以在子布局中调用
<a href="./yii-base-view.html#beginContent()-detail">beginContent()</a> 和<a href="./yii-base-view.html#endContent()-detail">endContent()</a>
方法，如下所示：</p>
<pre><code class="language-php"><span style="color: #0000BB">&lt;?php&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">beginContent</span><span style="color: #007700">(</span><span style="color: #DD0000">'@app/views/layouts/base.php'</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span><br />...child&nbsp;layout&nbsp;content&nbsp;here...<br /><br /><span style="color: #0000BB">&lt;?php&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">endContent</span><span style="color: #007700">();&nbsp;</span><span style="color: #0000BB">?&gt;</span></code></pre>
<p>如上所示，子布局内容应在 <a href="./yii-base-view.html#beginContent()-detail">beginContent()</a> 和
<a href="./yii-base-view.html#endContent()-detail">endContent()</a> 方法之间，传给 <a href="./yii-base-view.html#beginContent()-detail">beginContent()</a>
的参数指定父布局，父布局可为布局文件或别名。</p>
<p>使用以上方式可多层嵌套布局。</p>
<h3>使用数据块 <a name="using-blocks"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>数据块可以在一个地方指定视图内容在另一个地方显示，通常和布局一起使用，
例如，可在内容视图中定义数据块在布局中显示它。</p>
<p>调用 <a href="./yii-base-view.html#beginBlock()-detail">beginBlock()</a> 和 <a href="./yii-base-view.html#endBlock()-detail">endBlock()</a> 来定义数据块，
使用 <code>$view-&gt;blocks[$blockID]</code> 访问该数据块，其中 <code>$blockID</code> 为定义数据块时指定的唯一标识ID。</p>
<p>如下实例显示如何在内容视图中使用数据块让布局使用。</p>
<p>首先，在内容视图中定一个或多个数据块：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">...<br /><br />&lt;?</span><span style="color: #0000BB">php&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">beginBlock</span><span style="color: #007700">(</span><span style="color: #DD0000">'block1'</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span><br />...content&nbsp;of&nbsp;block1...<br /><br /><span style="color: #0000BB">&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">endBlock</span><span style="color: #007700">();&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span><br />...<br /><br /><span style="color: #0000BB">&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">beginBlock</span><span style="color: #007700">(</span><span style="color: #DD0000">'block3'</span><span style="color: #007700">);&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span><br />...content&nbsp;of&nbsp;block3...<br /><br /><span style="color: #0000BB">&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">endBlock</span><span style="color: #007700">();&nbsp;</span><span style="color: #0000BB">?&gt;</span></code></pre>
<p>然后，在布局视图中，数据块可用的话会渲染数据块，如果数据未定义则显示一些默认内容。</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">...<br />&lt;?</span><span style="color: #0000BB">php&nbsp;</span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">blocks</span><span style="color: #007700">[</span><span style="color: #DD0000">'block1'</span><span style="color: #007700">])):&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?=&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">blocks</span><span style="color: #007700">[</span><span style="color: #DD0000">'block1'</span><span style="color: #007700">]&nbsp;</span><span style="color: #0000BB">?&gt;<br />&nbsp;</span><span style="color: #007700">else:&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;default&nbsp;content&nbsp;for&nbsp;block1&nbsp;...<br /><span style="color: #0000BB">&nbsp;</span><span style="color: #007700">endif;&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span><br />...<br /><br /><span style="color: #0000BB">&nbsp;</span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">blocks</span><span style="color: #007700">[</span><span style="color: #DD0000">'block2'</span><span style="color: #007700">])):&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?=&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">blocks</span><span style="color: #007700">[</span><span style="color: #DD0000">'block2'</span><span style="color: #007700">]&nbsp;</span><span style="color: #0000BB">?&gt;<br />&nbsp;</span><span style="color: #007700">else:&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;default&nbsp;content&nbsp;for&nbsp;block2&nbsp;...<br /><span style="color: #0000BB">&nbsp;</span><span style="color: #007700">endif;&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span><br />...<br /><br /><span style="color: #0000BB">&nbsp;</span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">blocks</span><span style="color: #007700">[</span><span style="color: #DD0000">'block3'</span><span style="color: #007700">])):&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?=&nbsp;$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">blocks</span><span style="color: #007700">[</span><span style="color: #DD0000">'block3'</span><span style="color: #007700">]&nbsp;</span><span style="color: #0000BB">?&gt;<br />&nbsp;</span><span style="color: #007700">else:&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;default&nbsp;content&nbsp;for&nbsp;block3&nbsp;...<br /><span style="color: #0000BB">&nbsp;</span><span style="color: #007700">endif;&nbsp;</span><span style="color: #0000BB">?&gt;<br /></span>..</code></pre>
<h2>使用视图组件 <a name="using-view-components"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p><a href="./yii-base-view.html">View components</a>视图组件提供许多视图相关特性，可创建<a href="./yii-base-view.html">yii\base\View</a>或它的子类实例来获取视图组件，
大多数情况下主要使用 <code>view</code> 应用组件，可在<a href="guide-structure-applications.html#application-configurations">应用配置</a>中配置该组件，
如下所示：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">[<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'components'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'view'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'class'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'app\components\View'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;...<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">],<br />]</span></code></pre>
<p>视图组件提供如下实用的视图相关特性，每项详情会在独立章节中介绍：</p>
<ul>
<li><a href="guide-output-theming.html">主题</a>: 允许为你的Web站点开发和修改主题；</li>
<li><a href="guide-caching-fragment.html">片段缓存</a>: 允许你在Web页面中缓存片段；</li>
<li><a href="guide-output-client-scripts.html">客户脚本处理</a>: 支持CSS 和 JavaScript 注册和渲染；</li>
<li><a href="guide-structure-assets.html">资源包处理</a>: 支持 <a href="guide-structure-assets.html">资源包</a>的注册和渲染；</li>
<li><a href="guide-tutorial-template-engines.html">模板引擎</a>: 允许你使用其他模板引擎，如
<a href="http://twig.sensiolabs.org/">Twig</a>, <a href="http://www.smarty.net/">Smarty</a>。</li>
</ul>
<p>开发Web页面时，也可能频繁使用以下实用的小特性。</p>
<h3>设置页面标题 <a name="setting-page-titles"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>每个Web页面应有一个标题，正常情况下标题的标签显示在 <a href="#layouts">布局</a>中，
但是实际上标题大多由内容视图而不是布局来决定，为解决这个问题， <a href="./yii-web-view.html">yii\web\View</a> 提供
<a href="./yii-web-view.html#$title-detail">title</a> 标题属性可让标题信息从内容视图传递到布局中。</p>
<p>为利用这个特性，在每个内容视图中设置页面标题，如下所示：</p>
<pre><code class="language-php"><span style="color: #0000BB">&lt;?php<br />$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">title&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'My&nbsp;page&nbsp;title'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span></code></pre>
<p>然后在视图中，确保在 <code>&lt;head&gt;</code> 段中有如下代码：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">title</span><span style="color: #007700">&gt;&lt;?=&nbsp;</span><span style="color: #0000BB">Html</span><span style="color: #007700">::</span><span style="color: #0000BB">encode</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">title</span><span style="color: #007700">)&nbsp;</span><span style="color: #0000BB">?&gt;</span>&lt;/title&gt</code></pre>
<h3>注册Meta元标签 <a name="registering-meta-tags"></a> <a href="#meta" name="meta" class="hashlink">&para;</a></h3><p>Web页面通常需要生成各种元标签提供给不同的浏览器，如<code>&lt;head&gt;</code>中的页面标题，元标签通常在布局中生成。</p>
<p>如果想在内容视图中生成元标签，可在内容视图中调用<a href="./yii-web-view.html#registerMetaTag()-detail">yii\web\View::registerMetaTag()</a>方法，如下所示：</p>
<pre><code class="language-php"><span style="color: #0000BB">&lt;?php<br />$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">registerMetaTag</span><span style="color: #007700">([</span><span style="color: #DD0000">'name'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'keywords'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'content'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'yii,&nbsp;framework,&nbsp;php'</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">?&gt;</span></code></pre>
<p>以上代码会在视图组件中注册一个 "keywords" 元标签，在布局渲染后会渲染该注册的元标签，
然后，如下HTML代码会插入到布局中调用<a href="./yii-web-view.html#head()-detail">yii\web\View::head()</a>方法处：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">&lt;</span><span style="color: #0000BB">meta&nbsp;name</span><span style="color: #007700">=</span><span style="color: #DD0000">"keywords"&nbsp;</span><span style="color: #0000BB">content</span><span style="color: #007700">=</span><span style="color: #DD0000">"yii,&nbsp;framework,&nbsp;php"</span><span style="color: #007700">&gt;</span></code></pre>
<p>注意如果多次调用 <a href="./yii-web-view.html#registerMetaTag()-detail">yii\web\View::registerMetaTag()</a> 方法，它会注册多个元标签，注册时不会检查是否重复。</p>
<p>为确保每种元标签只有一个，可在调用方法时指定键作为第二个参数，
例如，如下代码注册两次 "description" 元标签，但是只会渲染第二个。</p>
<pre><code class="language-html">$this-&gt;registerMetaTag(['name' =&gt; 'description', 'content' =&gt; 'This is my cool website made with Yii!'], 'description');
$this-&gt;registerMetaTag(['name' =&gt; 'description', 'content' =&gt; 'This website is about funny raccoons.'], 'description');
</code></pre>
<h3>注册链接标签 <a name="registering-link-tags"></a> <a href="#" name="" class="hashlink">&para;</a></h3><p>和 <a href="#adding-meta-tags">Meta标签</a> 类似，链接标签有时很使用，如自定义网站图标，指定Rss订阅，或授权OpenID到其他服务器。
可以和元标签相似的方式调用<a href="./yii-web-view.html#registerLinkTag()-detail">yii\web\View::registerLinkTag()</a>，例如，在内容视图中注册链接标签如下所示：</p>
<pre><code class="language-php"><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">registerLinkTag</span><span style="color: #007700">([<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'title'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'Live&nbsp;News&nbsp;for&nbsp;Yii'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'rel'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'alternate'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'type'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'application/rss+xml'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'href'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'http://www.yiiframework.com/rss.xml/'</span><span style="color: #007700">,<br />]);</span></code></pre>
<p>上述代码会转换成</p>
<pre><code class="language-html">&lt;link title="Live News for Yii" rel="alternate" type="application/rss+xml" href="http://www.yiiframework.com/rss.xml/"&gt;
</code></pre>
<p>和 <a href="./yii-web-view.html#registerMetaTag()-detail">registerMetaTags()</a> 类似，
调用<a href="./yii-web-view.html#registerLinkTag()-detail">registerLinkTag()</a> 指定键来避免生成重复链接标签。</p>
<h2>视图事件 <a name="view-events"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p><a href="./yii-base-view.html">View components</a> 视图组件会在视图渲染过程中触发几个事件，
可以在内容发送给终端用户前，响应这些事件来添加内容到视图中或调整渲染结果。</p>
<ul>
<li><p>该事件可设置 <a href="./yii-base-viewevent.html#$isValid-detail">yii\base\ViewEvent::$isValid</a> 为 false 取消视图渲染。</p>
</li>
<li><a href="./yii-base-view.html#EVENT_AFTER_RENDER-detail">EVENT_AFTER_RENDER</a>: 在布局中调用 <a href="./yii-base-view.html#beginPage()-detail">yii\base\View::beginPage()</a> 时触发，
该事件可获取<a href="./yii-base-viewevent.html#$output-detail">yii\base\ViewEvent::$output</a>的渲染结果，可修改该属性来修改渲染结果。</li>
<li><a href="./yii-base-view.html#EVENT_BEGIN_PAGE-detail">EVENT_BEGIN_PAGE</a>: 在布局调用 <a href="./yii-base-view.html#beginPage()-detail">yii\base\View::beginPage()</a> 时触发；</li>
<li><a href="./yii-base-view.html#EVENT_END_PAGE-detail">EVENT_END_PAGE</a>: 在布局调用 <a href="./yii-base-view.html#endPage()-detail">yii\base\View::endPage()</a> 是触发；</li>
<li><a href="./yii-web-view.html#EVENT_BEGIN_BODY-detail">EVENT_BEGIN_BODY</a>: 在布局调用 <a href="./yii-web-view.html#beginBody()-detail">yii\web\View::beginBody()</a> 时触发；</li>
<li><a href="./yii-web-view.html#EVENT_END_BODY-detail">EVENT_END_BODY</a>: 在布局调用 <a href="./yii-web-view.html#endBody()-detail">yii\web\View::endBody()</a> 时触发。</li>
</ul>
<p>例如，如下代码将当前日期添加到页面结尾处：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">\</span><span style="color: #0000BB">Yii</span><span style="color: #007700">::</span><span style="color: #0000BB">$app</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">view</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">on</span><span style="color: #007700">(</span><span style="color: #0000BB">View</span><span style="color: #007700">::</span><span style="color: #0000BB">EVENT_END_BODY</span><span style="color: #007700">,&nbsp;function&nbsp;()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">date</span><span style="color: #007700">(</span><span style="color: #DD0000">'Y-m-d'</span><span style="color: #007700">);<br />});</span></code></pre>
<h2>渲染静态页面 <a name="rendering-static-pages"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p>静态页面值得是大部分内容为静态的不需要控制器传递动态数据的Web页面。</p>
<p>可将HTML代码放置在视图中，在控制器中使用以下代码输出静态页面：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">actionAbout</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">render</span><span style="color: #007700">(</span><span style="color: #DD0000">'about'</span><span style="color: #007700">);<br />}</span></code></pre>
<p>如果Web站点包含很多静态页面，多次重复相似的代码显得很繁琐，
为解决这个问题，可以使用一个在控制器中称为 <a href="./yii-web-viewaction.html">yii\web\ViewAction</a> 的<a href="guide-structure-controllers.html#standalone-actions">独立操作</a>。
例如：</p>
<pre><code class="language-php"><span style="color: #0000BB"></span><span style="color: #007700">namespace&nbsp;</span><span style="color: #0000BB">app</span><span style="color: #007700">\</span><span style="color: #0000BB">controllers</span><span style="color: #007700">;<br /><br />use&nbsp;</span><span style="color: #0000BB">yii</span><span style="color: #007700">\</span><span style="color: #0000BB">web</span><span style="color: #007700">\</span><span style="color: #0000BB">Controller</span><span style="color: #007700">;<br /><br />class&nbsp;</span><span style="color: #0000BB">SiteController&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">Controller<br /></span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;</span><span style="color: #0000BB">actions</span><span style="color: #007700">()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'page'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'class'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'yii\web\ViewAction'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}</span></code></pre>
<p>现在如果你在<code>@app/views/site/pages</code>目录下创建名为 <code>about</code> 的视图，
可通过如下rul显示该视图：</p>
<pre><code>http://localhost/index.php?r=site/page&amp;view=about
</code></pre>
<p><code>GET</code> 中 <code>view</code> 参数告知 <a href="./yii-web-viewaction.html">yii\web\ViewAction</a> 操作请求哪个视图，然后操作在
<code>@app/views/site/pages</code>目录下寻找该视图，可配置 <a href="./yii-web-viewaction.html#$viewPrefix-detail">yii\web\ViewAction::$viewPrefix</a>
修改搜索视图的目录。</p>
<h2>最佳实践 <a name="best-practices"></a> <a href="#" name="" class="hashlink">&para;</a></h2><p>视图负责将模型的数据展示用户想要的格式，总之，视图</p>
<ul>
<li>应主要包含展示代码，如HTML, 和简单的PHP代码来控制、格式化和渲染数据；</li>
<li>不应包含执行数据查询代码，这种代码放在模型中；</li>
<li>应避免直接访问请求数据，如 <code>$_GET</code>, <code>$_POST</code>，这种应在控制器中执行，
如果需要请求数据，应由控制器推送到视图。</li>
<li>可读取模型属性，但不应修改它们。</li>
</ul>
<p>为使模型更易于维护，避免创建太复杂或包含太多冗余代码的视图，可遵循以下方法达到这个目标：</p>
<ul>
<li>使用 <a href="#layouts">布局</a> 来展示公共代码（如，页面头部、尾部）；</li>
<li>将复杂的视图分成几个小视图，可使用上面描述的渲染方法将这些小视图渲染并组装成大视图；</li>
<li>创建并使用 <a href="guide-structure-widgets.html">小部件</a> 作为视图的数据块；</li>
<li>创建并使用助手类在视图中转换和格式化数据。</li>
</ul>
        <div class="toplink"><a href="#" class="h1" title="go to top"><span class="glyphicon glyphicon-arrow-up"></a></div>
    </div>
</div>


</div>

<footer class="footer">
        <p class="pull-right"><small>Page generated on Sat, 25 Oct 2014 15:17:34 +0200</small></p>
    Powered by <a href="http://www.yiiframework.com/" rel="external">Yii Framework</a></footer>

<script type="text/javascript">jQuery(document).ready(function () {
    var shiftWindow = function () { scrollBy(0, -50) };
    if (location.hash) shiftWindow();
    window.addEventListener("hashchange", shiftWindow);
var element = document.createElement("script");
element.src = "./jssearch.index.js";
document.body.appendChild(element);

var searchBox = $('#searchbox');

// focus the search field
searchBox.focus();

// search when typing in search field
searchBox.on("keyup", function(event) {
    var query = $(this).val();

    if (query == '' || event.which == 27) {
        $('#search-resultbox').hide();
        return;
    } else if (event.which == 13) {
        var selectedLink = $('#search-resultbox a.selected');
        if (selectedLink.length != 0) {
            document.location = selectedLink.attr('href');
            return;
        }
    } else if (event.which == 38 || event.which == 40) {
        $('#search-resultbox').show();

        var selected = $('#search-resultbox a.selected');
        if (selected.length == 0) {
            $('#search-results').find('a').first().addClass('selected');
        } else {
            var next;
            if (event.which == 40) {
                next = selected.parent().next().find('a').first();
            } else {
                next = selected.parent().prev().find('a').first();
            }
            if (next.length != 0) {
                var resultbox = $('#search-results');
                var position = next.position();

//              TODO scrolling is buggy and jumps around
//                resultbox.scrollTop(Math.floor(position.top));
//                console.log(position.top);

                selected.removeClass('selected');
                next.addClass('selected');
            }
        }

        return;
    }
    $('#search-resultbox').show();
    $('#search-results').html('<li><span class="no-results">No results</span></li>');

    var result = jssearch.search(query);

    if (result.length > 0) {
        var i = 0;
        var resHtml = '';

        for (var key in result) {
            if (i++ > 20) {
                break;
            }
            resHtml = resHtml +
            '<li><a href="' + result[key].file.u.substr(3) +'"><span class="title">' + result[key].file.t + '</span>' +
            '<span class="description">' + result[key].file.d + '</span></a></li>';
        }
        $('#search-results').html(resHtml);
    }
});

// hide the search results on ESC
$(document).on("keyup", function(event) { if (event.which == 27) { $('#search-resultbox').hide(); } });
// hide search results on click to document
$(document).bind('click', function (e) { $('#search-resultbox').hide(); });
// except the following:
searchBox.bind('click', function(e) { e.stopPropagation(); });
$('#search-resultbox').bind('click', function(e) { e.stopPropagation(); });

});</script></body>
</html>
